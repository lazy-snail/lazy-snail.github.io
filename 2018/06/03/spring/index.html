<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">
  <meta 
    name="viewport"
    content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  <meta 
    http-equiv="X-UA-Compatible" 
    content="ie=edge">
  <meta 
    name="theme-color" 
    content="#fff" 
    id="theme-color">
  <meta 
    name="description" 
    content="æ‡’æ‡’æ‡’èœ—ç‰›ğŸŒ">
  <link 
    rel="icon" 
    href="/img/little-prince.png">
  <title>spring</title>
  
    
      <meta 
        property="og:title" 
        content="spring">
    
    
      <meta 
        property="og:url" 
        content="https://lazy-snail.github.io/2018/06/03/spring/index.html">
    
    
      <meta 
        property="og:img" 
        content="/img/little-prince.png">
    
    
    
      <meta 
        property="og:type" 
        content="article">
      <meta 
        property="og:article:published_time" 
        content="2018-06-03">
      <meta 
        property="og:article:modified_time" 
        content="2022-06-29">
      <meta 
        property="og:article:author" 
        content="Neil">
      
        
          <meta 
            property="og:article:tag" 
            content="java">
        
      
    
  
  <script>
    function loadScript(url, cb) {
      var script = document.createElement('script');
      script.src = url;
      if (cb) script.onload = cb;
      script.async = true;
      document.body.appendChild(script);
    }
    function loadCSS(href, data, attr) {
      var sheet = document.createElement('link');
      sheet.ref = 'stylesheet';
      sheet.href = href;
      sheet.dataset[data] = attr;
      document.head.appendChild(sheet);
    }
    function changeCSS(cssFile, data, attr) {
      var oldlink = document.querySelector(data);
      var newlink = document.createElement("link");
      newlink.setAttribute("rel", "stylesheet");
      newlink.setAttribute("href", cssFile);
      newlink.dataset.prism = attr;
      document.head.replaceChild(newlink, oldlink);
    }
  </script>
  
    
      
      
      
      
        
        
        
        <script>
          function prismThemeChange() {
            if(document.getElementById('theme-color').dataset.mode === 'dark') {
              if(document.querySelector('[data-prism]')) {
                changeCSS('/js/lib/prism/prism-tomorrow.min.css', '[data-prism]', 'prism-tomorrow');
              } else {
                loadCSS('/js/lib/prism/prism-tomorrow.min.css', 'prism', 'prism-tomorrow');
              }
            } else {
              if(document.querySelector('[data-prism]')) {
                changeCSS('/js/lib/prism/prism.min.css', '[data-prism]', 'prism');
              } else {
                loadCSS('/js/lib/prism/prism.min.css', 'prism', 'prism');
              }
            }
          }
          prismThemeChange()
        </script>
      
      
        
        <link rel="stylesheet" href="/js/lib/prism/prism-line-numbers.min.css">
      
    
  
  <script>
    // control reverse button
    var reverseDarkList = {
      dark: 'light',
      light: 'dark'
    };
    var themeColor = {
      dark: '#1c1c1e',
      light: '#fff'
    }
    // get the data of css prefers-color-scheme
    var getCssMediaQuery = function() {
      return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    };
    // reverse current darkmode setting function
    var reverseDarkModeSetting = function() {
      var setting = localStorage.getItem('user-color-scheme');
      if(reverseDarkList[setting]) {
        setting = reverseDarkList[setting];
      } else if(setting === null) {
        setting = reverseDarkList[getCssMediaQuery()];
      } else {
        return;
      }
      localStorage.setItem('user-color-scheme', setting);
      return setting;
    };
    // apply current darkmode setting
  </script>
  
    <script>
      var setDarkmode = function(mode) {
      var setting = mode || localStorage.getItem('user-color-scheme');
      if(setting === getCssMediaQuery()) {
        document.documentElement.removeAttribute('data-user-color-scheme');
        localStorage.removeItem('user-color-scheme');
        document.getElementById('theme-color').content = themeColor[setting];
        document.getElementById('theme-color').dataset.mode = setting;
        prismThemeChange();
      } else if(reverseDarkList[setting]) {
        document.documentElement.setAttribute('data-user-color-scheme', setting);
        document.getElementById('theme-color').content = themeColor[setting];
        document.getElementById('theme-color').dataset.mode = setting;
        prismThemeChange();
      } else {
        document.documentElement.removeAttribute('data-user-color-scheme');
        localStorage.removeItem('user-color-scheme');
        document.getElementById('theme-color').content = themeColor[getCssMediaQuery()];
        document.getElementById('theme-color').dataset.mode = getCssMediaQuery();
        prismThemeChange();
      }
    };
    setDarkmode();
    </script>
  
  
  <link rel="preload" href="//at.alicdn.com/t/font_1946621_i1kgafibvw.css" as="style" >
  <link rel="preload" href="//at.alicdn.com/t/font_1952792_89b4ac4k4up.css" as="style" >
  
  
    <link rel="preload" href="/js/lib/lightbox/baguetteBox.min.js" as="script">
    <link rel="preload" href="/js/lib/lightbox/baguetteBox.min.css" as="style" >
  
  
    <link rel="preload" href="/js/lib/lozad.min.js" as="script">
  
  
  
  
    
    <link rel="prefetch" href="//cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-svg.js" as="script">
  
  
  
  
  <link rel="stylesheet" href="/css/main.css">
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1946621_i1kgafibvw.css">
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1952792_89b4ac4k4up.css">
  
    <link rel="stylesheet" href="/js/lib/lightbox/baguetteBox.min.css">
  
<meta name="generator" content="Hexo 6.1.0"></head>

  <body>
    <div class="wrapper">
       
      <nav class="navbar">
  <div class="navbar-logo">
    <span class="navbar-logo-main">
      
        <img 
          class="navbar-logo-img"
          width="32"
          height="32"
          src="/img/little-prince.png" 
          alt="blog logo">
      
      <span class="navbar-logo-dsc">æ‡’èœ—ç‰›</span>
    </span>
  </div>
  <div class="navbar-menu">
    
      <a 
        href="/" 
        class="navbar-menu-item">
        
          Home
        
      </a>
    
      <a 
        href="/archives" 
        class="navbar-menu-item">
        
          Archive
        
      </a>
    
      <a 
        href="/tags" 
        class="navbar-menu-item">
        
          Tags
        
      </a>
    
      <a 
        href="/categories" 
        class="navbar-menu-item">
        
          Categories
        
      </a>
    
      <a 
        href="/about" 
        class="navbar-menu-item">
        
          About
        
      </a>
    
    <a 
      class="navbar-menu-item darknavbar" 
      id="dark">
      <i class="iconfont icon-weather"></i>
    </a>
    <a 
      class="navbar-menu-item searchnavbar" 
      id="search">
      <i 
        class="iconfont icon-search" 
        style="font-size: 1.2rem; font-weight: 400;">
      </i>
    </a>
  </div>
</nav> 
      
      <div 
        id="local-search" 
        style="display: none">
        <input
          class="navbar-menu-item"
          id="search-input"
          placeholder="è¯·è¾“å…¥æœç´¢å†…å®¹..." />
        <div id="search-content"></div>
      </div>
      
      <div class="section-wrap">
        <div class="container">
          <div class="columns">
            <main class="main-column">
<article class="card card-content">
  <header>
    <h1 class="post-title">
      spring
    </h1>
  </header>
  <div class="post-meta post-show-meta">
    <time datetime="2018-06-03T07:15:38.000Z">
      <i 
        class="iconfont icon-calendar" 
        style="margin-right: 2px;">
      </i>
      <span>2018-06-03</span>
    </time>
    
      <span class="dot"></span>
      
        <a 
          href="/categories/java/" 
          class="post-meta-link">
          java
        </a>
      
    
    
      <span class="dot"></span>
      <span>8.5k words</span>
    
  </div>
  
    <div 
      class="post-meta post-show-meta" 
      style="margin-top: -10px;">
      <div style="display: flex; align-items: center;">
        <i 
          class="iconfont icon-biaoqian" 
          style="margin-right: 2px; font-size: 1.15rem;">
        </i>
        
          
          <a 
            href="/tags/java/" 
            class="post-meta-link">
            java
          </a>
        
      </div>
    </div>
  
  </header>
  <div 
    id="section" 
    class="post-content">
    <p>[toc]</p>
<h1 id="ç»„ä»¶"><a href="#ç»„ä»¶" class="headerlink" title="ç»„ä»¶"></a>ç»„ä»¶</h1><h1 id="SpringBootå¯åŠ¨è¿‡ç¨‹"><a href="#SpringBootå¯åŠ¨è¿‡ç¨‹" class="headerlink" title="SpringBootå¯åŠ¨è¿‡ç¨‹"></a>SpringBootå¯åŠ¨è¿‡ç¨‹</h1><h1 id="è¯·æ±‚å¤„ç†è¿‡ç¨‹"><a href="#è¯·æ±‚å¤„ç†è¿‡ç¨‹" class="headerlink" title="è¯·æ±‚å¤„ç†è¿‡ç¨‹"></a>è¯·æ±‚å¤„ç†è¿‡ç¨‹</h1><p>ä»¥å…¸å‹çš„webåº”ç”¨ä¸ºä¾‹ï¼Œä¸€ä¸ªè¯·æ±‚ä»æ¥æ”¶åˆ°è¿”å›çš„å¤„ç†è¿‡ç¨‹ç›¸å½“å¤æ‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸»è¦ç»è¿‡DispatcherServletã€HandlerMappingã€Controllerã€ViewResolverã€Modelç­‰ï¼š<br><img src="/2018/06/03/spring/%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86.png" alt="request handle" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2018/06/03/spring/%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86.png" class="lozad post-image"></p>
<ol>
<li>å®¢æˆ·ç«¯è¯·æ±‚æäº¤åˆ°DispatcherServletï¼›</li>
<li>ç”±DisPatcherServletæ§åˆ¶å™¨å¯»æ‰¾ä¸€ä¸ªæˆ–å¤šä¸ªHandlerMappingï¼Œæ‰¾åˆ°å¤„ç†è¯·æ±‚çš„Controllerï¼›</li>
<li>DispatcherServletå°†è¯·æ±‚æäº¤åˆ°Controllerï¼›</li>
<li>Controllerè°ƒç”¨ä¸šåŠ¡é€»è¾‘å¤„ç†åè¿”å›ModelAndViewï¼›</li>
<li>DispatcherServletå¯»æ‰¾ä¸€ä¸ªæˆ–å¤šä¸ªViewResolverè§†å›¾è§£æå™¨ï¼Œæ‰¾åˆ°ModelAndViewæŒ‡å®šçš„è§†å›¾ï¼›</li>
<li>è§†å›¾è´Ÿè´£å°†ç»“æœæ˜¾ç¤ºåˆ°å®¢æˆ·ç«¯ã€‚</li>
</ol>
<p>Spring MVCæ‰€æœ‰çš„è¯·æ±‚éƒ½ç»è¿‡DispatcherServletæ¥ç»Ÿä¸€åˆ†å‘ï¼Œåœ¨ DispatcherServletå°†è¯·æ±‚åˆ†å‘ç»™Controllerä¹‹å‰éœ€è¦å€ŸåŠ©Spring MVCæä¾›çš„ HandlerMappingå®šä½åˆ°å…·ä½“çš„Controllerã€‚<br>HandlerMappingæ¥å£è´Ÿè´£å®Œæˆå®¢æˆ·è¯·æ±‚åˆ°Controlleræ˜ å°„ã€‚<br>Controlleræ¥å£å°†å¤„ç†ç”¨æˆ·è¯·æ±‚ï¼Œè¿™å’ŒJava Servletæ‰®æ¼”çš„è§’è‰²æ˜¯ä¸€è‡´çš„ã€‚ä¸€æ—¦Controllerå¤„ç†å®Œç”¨æˆ·è¯·æ±‚ï¼Œå°†è¿”å›ModelAndViewå¯¹è±¡ç»™DispatcherServletå‰ç«¯æ§åˆ¶å™¨ï¼ŒModelAndViewä¸­åŒ…å«äº†æ¨¡å‹ï¼ˆModelï¼‰å’Œè§†å›¾ï¼ˆViewï¼‰ã€‚<br>ä»å®è§‚è§’åº¦è€ƒè™‘ï¼ŒDispatcherServletæ˜¯æ•´ä¸ªWebåº”ç”¨çš„æ§åˆ¶å™¨ï¼›ä»å¾®è§‚è€ƒè™‘ï¼ŒControlleræ˜¯å•ä¸ªHttpè¯·æ±‚å¤„ç†è¿‡ç¨‹ä¸­çš„æ§åˆ¶å™¨ï¼Œè€ŒModelAndViewæ˜¯Httpè¯·æ±‚è¿‡ç¨‹ä¸­è¿”å›çš„æ¨¡å‹ï¼ˆModelï¼‰å’Œè§†å›¾ï¼ˆViewï¼‰ã€‚<br>ViewResolveræ¥å£ï¼ˆè§†å›¾è§£æå™¨ï¼‰åœ¨Webåº”ç”¨ä¸­è´Ÿè´£æŸ¥æ‰¾Viewå¯¹è±¡ï¼Œä»è€Œå°†ç›¸åº”ç»“æœæ¸²æŸ“ç»™å®¢æˆ·ã€‚</p>
<h1 id="è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨"><a href="#è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨" class="headerlink" title="è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨"></a>è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨</h1><p>è¿™å¼ å›¾è§£é‡Šäº†å…¸å‹springåº”ç”¨å¸¸ç”¨ç»„ä»¶åŠè§¦å‘é¡ºåºï¼š<br><img src="/2018/06/03/spring/request.png" alt="request handle" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2018/06/03/spring/request.png" class="lozad post-image"><br>è¿‡æ»¤å™¨åœ¨è¯·æ±‚è¿›å…¥å®¹å™¨ä¹‹åã€è¿›å…¥servletä¹‹å‰å°±è¢«è§¦å‘ï¼Œæ­¤æ—¶è¿˜æ²¡æœ‰è¿›å…¥springçš„ç®¡è¾–èŒƒå›´ã€‚æ‹¦æˆªå™¨æ˜¯springæä¾›å¹¶ç®¡ç†çš„ï¼Œæ‰€ä»¥å®ƒèƒ½è·å–IoCå®¹å™¨ä¿¡æ¯ï¼Œæ¯”å¦‚æ‹¿åˆ°å®¹å™¨é‡Œçš„beanã€‚</p>
<p>è¿™å¼ å›¾è§£é‡Šäº†å¸¸ç”¨ç»„ä»¶å…·ä½“æ–¹æ³•çš„æ‰§è¡Œé¡ºåºï¼š<br><img src="/2018/06/03/spring/%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F.png" alt="request handle" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2018/06/03/spring/%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F.png" class="lozad post-image"></p>
<h2 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h2><p>Filteræ˜¯JavaEEä¸­Servletè§„èŒƒçš„ä¸€ä¸ªç»„ä»¶ï¼Œå®ƒå¯ä»¥åœ¨httpè¯·æ±‚åˆ°è¾¾Servletä¹‹å‰ï¼Œè¢«Nä¸ªFilterå¤„ç†ï¼š<br><img src="/2018/06/03/spring/filter.webp" alt="request handle" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2018/06/03/spring/filter.webp" class="lozad post-image"><br>è¿‡æ»¤å™¨çš„å®ç°æ˜¯åŸºäºå‡½æ•°å›è°ƒã€‚</p>
<h3 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h3><ul>
<li>è¿‡æ»¤æ•æ„Ÿè¯æ±‡ï¼ˆé˜²æ­¢sqlæ³¨å…¥ï¼‰</li>
<li>è®¾ç½®å­—ç¬¦ç¼–ç </li>
<li>URLçº§åˆ«çš„æƒé™è®¿é—®æ§åˆ¶</li>
<li>å‹ç¼©å“åº”ä¿¡æ¯</li>
</ul>
<h2 id="interceptor"><a href="#interceptor" class="headerlink" title="interceptor"></a>interceptor</h2><p>ç”¨äºæ‹¦æˆªControlleræ–¹æ³•çš„æ‰§è¡Œï¼Œå¯ä»¥åœ¨æ–¹æ³•æ‰§è¡Œã€åæ·»åŠ è‡ªå®šä¹‰é€»è¾‘ï¼Œç±»ä¼¼äºAOPç¼–ç¨‹æ€æƒ³ã€‚å…¶å®ç°æ˜¯åŸºäºåå°„æœºåˆ¶â€”â€”åŠ¨æ€ä»£ç†ã€‚</p>
<h3 id="åº”ç”¨åœºæ™¯-1"><a href="#åº”ç”¨åœºæ™¯-1" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h3><p>æ‹¦æˆªå™¨æœ¬è´¨ä¸Šæ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰ï¼Œç¬¦åˆæ¨ªåˆ‡å…³æ³¨ç‚¹çš„åŠŸèƒ½éƒ½å¯ä»¥æ”¾åœ¨æ‹¦æˆªå™¨ä¸­æ¥å®ç°ï¼Œä¸»è¦çš„åº”ç”¨åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ul>
<li>ç™»å½•éªŒè¯ï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•ã€‚</li>
<li>æƒé™éªŒè¯ï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯å¦æœ‰æƒé™è®¿é—®èµ„æºï¼Œå¦‚æ ¡éªŒtoken</li>
<li>æ—¥å¿—è®°å½•ï¼Œè®°å½•è¯·æ±‚æ“ä½œæ—¥å¿—ï¼ˆç”¨æˆ·ipï¼Œè®¿é—®æ—¶é—´ç­‰ï¼‰ï¼Œä»¥ä¾¿ç»Ÿè®¡è¯·æ±‚è®¿é—®é‡ã€‚</li>
<li>å¤„ç†cookieã€æœ¬åœ°åŒ–ã€å›½é™…åŒ–ã€ä¸»é¢˜ç­‰ã€‚</li>
<li>æ€§èƒ½ç›‘æ§ï¼Œç›‘æ§è¯·æ±‚å¤„ç†æ—¶é•¿ç­‰ã€‚</li>
<li>é€šç”¨è¡Œä¸ºï¼šè¯»å–cookieå¾—åˆ°ç”¨æˆ·ä¿¡æ¯å¹¶å°†ç”¨æˆ·å¯¹è±¡æ”¾å…¥è¯·æ±‚ï¼Œä»è€Œæ–¹ä¾¿åç»­æµç¨‹ä½¿ç”¨ï¼Œè¿˜æœ‰å¦‚æå–Localeã€Themeä¿¡æ¯ç­‰ï¼Œåªè¦æ˜¯å¤šä¸ªå¤„ç†å™¨éƒ½éœ€è¦çš„å³å¯ä½¿ç”¨æ‹¦æˆªå™¨å®ç°ï¼‰</li>
</ul>
<h1 id="åå¤„ç†å™¨"><a href="#åå¤„ç†å™¨" class="headerlink" title="åå¤„ç†å™¨"></a>åå¤„ç†å™¨</h1><h1 id="ç›‘å¬å™¨"><a href="#ç›‘å¬å™¨" class="headerlink" title="ç›‘å¬å™¨"></a>ç›‘å¬å™¨</h1><h1 id="ä¸‰çº§ç¼“å­˜"><a href="#ä¸‰çº§ç¼“å­˜" class="headerlink" title="ä¸‰çº§ç¼“å­˜"></a>ä¸‰çº§ç¼“å­˜</h1><p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1497692">https://cloud.tencent.com/developer/article/1497692</a></p>
<h1 id="beanç”Ÿå‘½å‘¨æœŸ"><a href="#beanç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="beanç”Ÿå‘½å‘¨æœŸ"></a>beanç”Ÿå‘½å‘¨æœŸ</h1><p>Springå®¹å™¨ä¸­Beançš„ç”Ÿå‘½å‘¨æœŸç”±å¤šä¸ªç‰¹å®šçš„é˜¶æ®µç»„æˆï¼Œæ¯ä¸ªé˜¶æ®µéƒ½å…è®¸å¤–ç•Œå¯¹BeanåŠ ä»¥æ§åˆ¶ã€‚åœ¨Springä¸­å¯ä»¥ä»ä¸¤ä¸ªå±‚é¢å®šä¹‰Beançš„ç”Ÿå‘½å‘¨æœŸï¼šBeançš„ä½œç”¨èŒƒå›´ï¼›å®ä¾‹åŒ–Beanæ—¶æ‰€ç»å†çš„ä¸€ç³»åˆ—é˜¶æ®µã€‚</p>
<h2 id="æ–‡å­—æè¿°"><a href="#æ–‡å­—æè¿°" class="headerlink" title="æ–‡å­—æè¿°"></a>æ–‡å­—æè¿°</h2><ol>
<li><p>Beanå®¹å™¨åœ¨é…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ°Spring Beançš„å®šä¹‰ã€‚</p>
</li>
<li><p>Beanå®¹å™¨ä½¿ç”¨Java Reflection APIåˆ›å»ºBeançš„å®ä¾‹ã€‚</p>
</li>
<li><p>å¦‚æœå£°æ˜äº†ä»»ä½•å±æ€§ï¼Œå£°æ˜çš„å±æ€§ä¼šè¢«è®¾ç½®ã€‚å¦‚æœå±æ€§æœ¬èº«æ˜¯Beanï¼Œåˆ™å°†å¯¹å…¶è¿›è¡Œè§£æå’Œè®¾ç½®ã€‚<br>ä»¥ä¸Šæ­¥éª¤è§â€œspring IoC æºç è§£æâ€ã€‚</p>
</li>
<li><p>å¦‚æœBeanç±»å®ç°BeanNameAwareæ¥å£ï¼Œåˆ™å°†é€šè¿‡ä¼ é€’Beançš„åç§°æ¥è°ƒç”¨setBeanName()æ–¹æ³•ã€‚<br>å¦‚æœBeanç±»å®ç°BeanClassLoaderAwareæ¥å£ï¼Œåˆ™å°†é€šè¿‡ä¼ é€’åŠ è½½æ­¤Beançš„ClassLoaderå¯¹è±¡çš„å®ä¾‹æ¥è°ƒç”¨setBeanClassLoader()æ–¹æ³•ã€‚<br>å¦‚æœBeanç±»å®ç°BeanFactoryAwareæ¥å£ï¼Œåˆ™å°†é€šè¿‡ä¼ é€’BeanFactoryå¯¹è±¡çš„å®ä¾‹æ¥è°ƒç”¨setBeanFactory()æ–¹æ³•ã€‚<br>å¦‚æœæœ‰ä»»ä½•ä¸BeanFactoryå…³è”çš„BeanPostProcessorså¯¹è±¡å·²åŠ è½½Beanï¼Œåˆ™å°†åœ¨è®¾ç½®Beanå±æ€§ä¹‹å‰è°ƒç”¨postProcessBeforeInitialization()æ–¹æ³•ã€‚<br>å¦‚æœBeanç±»å®ç°äº†InitializingBeanæ¥å£ï¼Œåˆ™åœ¨è®¾ç½®äº†é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„æ‰€æœ‰Beanå±æ€§åï¼Œå°†è°ƒç”¨afterPropertiesSet()æ–¹æ³•ã€‚<br>å¦‚æœé…ç½®æ–‡ä»¶ä¸­çš„Beanå®šä¹‰åŒ…å«init-methodå±æ€§ï¼Œåˆ™è¯¥å±æ€§çš„å€¼å°†è§£æä¸ºBeanç±»ä¸­çš„æ–¹æ³•åç§°ï¼Œå¹¶å°†è°ƒç”¨è¯¥æ–¹æ³•ã€‚<br>å¦‚æœä¸ºBean Factoryå¯¹è±¡é™„åŠ äº†ä»»ä½•Bean åç½®å¤„ç†å™¨ï¼Œåˆ™å°†è°ƒç”¨postProcessAfterInitialization()æ–¹æ³•ã€‚<br>å¦‚æœBeanç±»å®ç°DisposableBeanæ¥å£ï¼Œåˆ™å½“Applicationä¸å†éœ€è¦Beanå¼•ç”¨æ—¶ï¼Œå°†è°ƒç”¨destroy()æ–¹æ³•ã€‚<br>å¦‚æœé…ç½®æ–‡ä»¶ä¸­çš„Beanå®šä¹‰åŒ…å«destroy-methodå±æ€§ï¼Œé‚£ä¹ˆå°†è°ƒç”¨Beanç±»ä¸­çš„ç›¸åº”æ–¹æ³•å®šä¹‰ã€‚</p>
</li>
</ol>
<h2 id="BeanFactoryä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ"><a href="#BeanFactoryä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="BeanFactoryä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ"></a>BeanFactoryä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ</h2><p><img src="https://raw.githubusercontent.com/lazy-snail/ImageHosting/master/wiki/Spring-Bean-LifeCycle.png" alt="Beanç”Ÿå‘½å‘¨æœŸ" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/lazy-snail/ImageHosting/master/wiki/Spring-Bean-LifeCycle.png" class="lozad post-image"><br>å…·ä½“è¿‡ç¨‹ï¼š</p>
<ol>
<li>å½“è°ƒç”¨è€…é€šè¿‡getBean(beanName)å‘å®¹å™¨è¯·æ±‚æŸä¸€ä¸ªBeanæ—¶ï¼Œå¦‚æœå®¹å™¨æ³¨å†Œäº†org.springframework.beans.factory.config.InstantiationAwareBeanPostProcessoræ¥å£ï¼Œåˆ™åœ¨å®ä¾‹åŒ–Beanä¹‹å‰ï¼Œå°†è°ƒç”¨æ¥å£çš„postProcessBeforeInstantiation()ï¼›</li>
<li>æ ¹æ®é…ç½®æƒ…å†µè°ƒç”¨Beanæ„é€ æ–¹æ³•æˆ–å·¥å‚æ–¹æ³•å®ä¾‹åŒ–Beanï¼›</li>
<li>å¦‚æœå®¹å™¨æ³¨å†Œäº†InstantiationAwareBeanPostProcessoræ¥å£ï¼Œé‚£ä¹ˆåœ¨å®ä¾‹åŒ–Beanä¹‹åï¼Œè°ƒç”¨è¯¥æ¥å£çš„postProcessAfterInstantiation()ï¼Œå¯åœ¨è¿™é‡Œå¯¹å·²ç»å®ä¾‹åŒ–çš„å¯¹è±¡è¿›è¡Œä¸€äº›â€œæ¢³å¦†æ‰“æ‰®â€ï¼›</li>
<li>å¦‚æœBeané…ç½®äº†å±æ€§ä¿¡æ¯ï¼Œé‚£ä¹ˆå®¹å™¨åœ¨è¿™ä¸€æ­¥ç€æ‰‹å°†é…ç½®å€¼è®¾ç½®åˆ°Beanå¯¹åº”çš„å±æ€§ä¸­ï¼Œä¸è¿‡åœ¨è®¾ç½®æ¯ä¸ªå±æ€§ä¹‹å‰å°†å…ˆè°ƒç”¨InstantiationAwareBeanPostProcessoræ¥å£çš„postProcessPropertyValues()ï¼›</li>
<li>è°ƒç”¨Beançš„å±æ€§è®¾ç½®æ–¹æ³•è®¾ç½®å±æ€§å€¼ï¼›</li>
<li>å¦‚æœBeanå®ç°äº†org.springframework.beans.factory.BeanNameAwareæ¥å£ï¼Œåˆ™å°†è°ƒç”¨setBeanName()ï¼Œå°†é…ç½®æ–‡ä»¶ä¸­è¯¥Beanå¯¹åº”çš„åç§°è®¾ç½®åˆ°Beanä¸­ï¼›</li>
<li>å¦‚æœBeanå®ç°äº†org.springframework.beans.factory.BeanFactoryAwareæ¥å£ï¼Œåˆ™å°†è°ƒç”¨setBeanFactory()ï¼Œå°†BeanFactoryå®¹å™¨å®ä¾‹è®¾ç½®åˆ°Beanä¸­ï¼›</li>
<li>å¦‚æœBeanFactoryè£…é…äº†org.springframework.beans.factory.config.BeanPostProcessoråå¤„ç†å™¨ï¼Œåˆ™å°†è°ƒç”¨BeanPostProcessorçš„Object postProcessBeforeInitialization(Object bean, String beanName)å¯¹Beanè¿›è¡ŒåŠ å·¥æ“ä½œã€‚å…¶ä¸­ï¼Œå…¥å‚beanæ˜¯å½“å‰æ­£åœ¨å¤„ç†çš„beanï¼ŒbeanNameæ—¶å½“å‰beançš„é…ç½®åï¼Œè¿”å›çš„å¯¹è±¡ä¸ºåŠ å·¥å¤„ç†åçš„Beanã€‚å¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•å¯¹Beanè¿›è¡Œå¤„ç†ï¼Œç”šè‡³æ”¹å˜Beançš„è¡Œä¸ºã€‚BeanPostProcessoråœ¨Springæ¡†æ¶ä¸­å æœ‰é‡è¦åœ°ä½ï¼Œä¸ºå®¹å™¨æä¾›å¯¹Beanè¿›è¡Œåç»­åŠ å·¥å¤„ç†çš„åˆ‡å…¥ç‚¹ï¼ŒSpringå®¹å™¨æ‰€æä¾›çš„å„ç§â€œç¥å¥‡åŠŸèƒ½â€ï¼Œå¦‚AOPï¼ŒåŠ¨æ€ä»£ç†ç­‰ï¼Œéƒ½æ˜¯é€šè¿‡å®ƒæ¥å®æ–½çš„ï¼›</li>
<li>å¦‚æœBeanå®ç°äº†InitializingBeanæ¥å£ï¼Œåˆ™å°†è°ƒç”¨æ¥å£çš„afterPropertiesSet()ï¼›</li>
<li>å¦‚æœåœ¨&lt;bean&gt;ä¸­é€šè¿‡init-methodå±æ€§å®šä¹‰äº†åˆå§‹åŒ–æ–¹æ³•ï¼Œåˆ™å°†æ‰§è¡Œè¿™ä¸ªæ–¹æ³•ï¼›</li>
<li>BeanPostProcessoråå¤„ç†å™¨å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•ï¼šå…¶ä¸€æ˜¯postProcessBeforeInitialization()ï¼Œåœ¨(8)æ­¥è°ƒç”¨ï¼›å…¶äºŒæ˜¯Object postProcessAfterInitialization(Object bean, String beanName)ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨æ­¤æ—¶è°ƒç”¨ï¼Œå®¹å™¨å†æ¬¡è·å¾—å¯¹Beanè¿›è¡ŒåŠ å·¥å¤„ç†çš„æœºä¼šï¼›</li>
<li>å¦‚æœåœ¨&lt;bean&gt;ä¸­æŒ‡å®šBeançš„ä½œç”¨èŒƒå›´æ˜¯scope&#x3D;â€prototypeâ€ï¼Œåˆ™å°†Beanè¿”å›ç»™è°ƒç”¨è€…ï¼Œè°ƒç”¨è€…è´Ÿè´£Beanåç»­ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ï¼ŒSpringä¸å†ç®¡ç†è¿™ä¸ªBeançš„ç”Ÿå‘½å‘¨æœŸã€‚å¦‚æœå°†ä½œç”¨èŒƒå›´è®¾ç½®ä¸ºscope&#x3D;â€singletonâ€ï¼Œåˆ™å°†Beanæ”¾å…¥Spring IoCå®¹å™¨çš„ç¼“å­˜æ± ä¸­ï¼Œå¹¶å°†Beanå¼•ç”¨è¿”å›ç»™è°ƒç”¨è€…ï¼ŒSpringç»§ç»­å¯¹è¿™äº›Beanè¿›è¡Œåç»­çš„ç”Ÿå‘½ç®¡ç†ï¼›</li>
<li>å¯¹äºscope&#x3D;â€singletonâ€çš„Beanï¼ˆé»˜è®¤æƒ…å†µï¼‰ï¼Œå½“å®¹å™¨å…³é—­æ—¶ï¼Œå°†è§¦å‘Springå¯¹Beanåç»­ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†å·¥ä½œã€‚å¦‚æœBeanå®ç°äº†DisposableBeanæ¥å£ï¼Œåˆ™å°†è°ƒç”¨æ¥å£çš„destory()ï¼Œå¯ä»¥åœ¨æ­¤ç¼–å†™é‡Šæ”¾èµ„æºã€è®°å½•æ—¥å¿—ç­‰æ“ä½œï¼›</li>
<li>å¯¹äºscope&#x3D;â€singletonâ€çš„Beanï¼Œå¦‚æœé€šè¿‡&lt;bean&gt;çš„destory-methodå±æ€§æŒ‡å®šäº†Beançš„é”€æ¯æ–¹æ³•ï¼Œé‚£ä¹ˆSpringå°†æ‰§è¡ŒBeançš„è¿™ä¸ªæ–¹æ³•ï¼Œå®ŒæˆBeanèµ„æºçš„é‡Šæ”¾ç­‰æ“ä½œã€‚</li>
</ol>
<p>Beançš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸä»Springå®¹å™¨ç€æ‰‹å®ä¾‹åŒ–Beanå¼€å§‹ï¼Œç›´åˆ°æœ€ç»ˆé”€æ¯Beanã€‚å…¶ä¸­ç»è¿‡äº†è®¸å¤šå…³é”®ç‚¹ï¼Œæ¯ä¸ªå…³é”®ç‚¹éƒ½æ¶‰åŠç‰¹å®šçš„æ–¹æ³•è°ƒç”¨ï¼Œå¯ä»¥å°†è¿™äº›æ–¹æ³•å¤§è‡´åˆ†ä¸º4ç±»ï¼š</p>
<ul>
<li>Beanè‡ªèº«çš„æ–¹æ³•ï¼šå¦‚è°ƒç”¨Beanæ„é€ æ–¹æ³•å®ä¾‹åŒ–Beanã€è°ƒç”¨setterè®¾ç½®Beançš„å±æ€§å€¼ä»¥åŠé€šè¿‡&lt;bean&gt;çš„init-methodå’Œdestory-methodæ‰€æŒ‡å®šçš„æ–¹æ³•ï¼›</li>
<li>Beançº§ç”Ÿå‘½å‘¨æœŸæ¥å£æ–¹æ³•ï¼šå¦‚BeanNameAwareã€BeanFactoryAwareã€InitializingBeanå’ŒDisposableBeanï¼Œè¿™äº›æ¥å£æ–¹æ³•ç”±Beanç±»ç›´æ¥å®ç°ï¼›</li>
<li>å®¹å™¨çº§ç”Ÿå‘½å‘¨æœŸæ¥å£æ–¹æ³•ï¼šå›¾ç¤ºä¸­â­æ ‡è¯†çš„æ­¥éª¤æ˜¯ç”±InstantiationAwareBeanPostProcessorå’ŒBeanPostProcessorè¿™ä¸¤ä¸ªæ¥å£å®ç°çš„ï¼Œä¸€èˆ¬ç§°å®ƒä»¬çš„å®ç°ç±»ä¸ºâ€œåå¤„ç†å™¨â€ã€‚åå¤„ç†å™¨æ¥å£ä¸€èˆ¬ä¸ç”±Beanæœ¬èº«å®ç°ï¼Œå®ƒä»¬ç‹¬ç«‹äºBeanï¼Œå®ç°ç±»ä»¥å®¹å™¨é™„åŠ è£…ç½®çš„å½¢å¼æ³¨å†Œåˆ°Springå®¹å™¨ä¸­ï¼Œå¹¶é€šè¿‡æ¥å£åå°„ä¸ºSpringå®¹å™¨æ‰«æè¯†åˆ«ã€‚å½“Springåˆ›å»ºä»»ä½•Beançš„æ—¶å€™ï¼Œè¿™äº›åå¤„ç†å™¨éƒ½ä¼šå‘ç”Ÿä½œç”¨ï¼Œæ‰€ä»¥è¿™äº›åå¤„ç†å™¨çš„å½±å“æ˜¯å…¨å±€æ€§çš„ã€‚ä¹Ÿå¯ä»¥è‡ªè¡Œç¼–å†™åå¤„ç†å™¨ï¼Œè®©å…¶ä»…å¯¹æ„Ÿå…´è¶£çš„Beanè¿›è¡ŒåŠ å·¥å¤„ç†ï¼›</li>
<li>å·¥å‚åå¤„ç†å™¨æ¥å£æ–¹æ³•ï¼šåŒ…æ‹¬AspectJWeavingEnablerã€CustomAutowireConfigurerã€ConfigurationClassPostProcessorç­‰æ–¹æ³•ã€‚å·¥å‚åå¤„ç†å™¨ä¹Ÿæ˜¯å®¹å™¨çº§çš„ï¼Œåœ¨åº”ç”¨ä¸Šä¸‹æ–‡è£…é…é…ç½®æ–‡ä»¶åç«‹å³è°ƒç”¨ã€‚</li>
</ul>
<h2 id="ApplicationContextä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ"><a href="#ApplicationContextä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ApplicationContextä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ"></a>ApplicationContextä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ</h2><p>Beanåœ¨åº”ç”¨ä¸Šä¸‹æ–‡ä¸­çš„ç”Ÿå‘½å‘¨æœŸå’Œåœ¨BeanFactoryä¸­çš„ç”Ÿå‘½å‘¨æœŸç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯ï¼Œå¦‚æœBeanå®ç°äº†org.springframework.context.ApplicationContextAwareæ¥å£ï¼Œåˆ™ä¼šå¢åŠ ä¸€ä¸ªè°ƒç”¨æ¥å£æ–¹æ³•setApplicationContext()çš„æ­¥éª¤ã€‚  </p>
<h2 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h2><p>Springå®šä¹‰äº†å¤šç§ä½œç”¨åŸŸï¼š</p>
<ul>
<li>å•ä¾‹ï¼ˆsingletonï¼‰ï¼Œåœ¨æ•´ä¸ªåº”ç”¨ä¸­ï¼Œåªåˆ›å»ºbeançš„ä¸€ä¸ªå®ä¾‹ã€‚</li>
<li>åŸå‹ï¼ˆprototypeï¼‰ï¼Œæ¯æ¬¡æ³¨å…¥æˆ–è€…é€šè¿‡Springåº”ç”¨ä¸Šä¸‹æ–‡è·å–çš„æ—¶å€™ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„beanå®ä¾‹ã€‚</li>
<li>ä¼šè¯ï¼ˆsessionï¼‰ï¼Œåœ¨webåº”ç”¨ä¸­ï¼Œä¸ºæ¯ä¸ªä¼šè¯åˆ›å»ºä¸€ä¸ªbeanå®ä¾‹ã€‚</li>
<li>è¯·æ±‚ï¼ˆrequestï¼‰ï¼Œåœ¨webåº”ç”¨ä¸­ï¼Œä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªbeanå®ä¾‹ã€‚</li>
</ul>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpringçš„æ‰€æœ‰beanéƒ½æ˜¯å•ä¾‹ï¼ˆsingletonï¼‰çš„ã€‚ä½¿ç”¨@Scopeæ³¨è§£æ¥é€‰æ‹©å…¶å®ƒä½œç”¨åŸŸï¼Œå®ƒå¯ä¸@Componentã€@Beanä¸€èµ·ä½¿ç”¨ã€‚ä¸¤ç§æ–¹å¼ï¼ˆæ¨è1ï¼‰ï¼š</p>
<ol>
<li>&#96;&#96;&#96;java<br> @Component<br> @Scope(ConfigurableBeanFactory.SCOPE_PROTOTYPE)<br> public class AClass{â€¦}<pre class="line-numbers language-none"><code class="language-none">2. &#96;&#96;&#96;java
    @Component
    @Scope(&quot;prototype&quot;)
    public class AClass&#123;...&#125;

   	@Override
	public Object getBean(String name) throws BeansException &#123;
		return doGetBean(name, null, null, false);
	&#125;
	<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
åœ¨xxxConfigç±»ä¸­ä½¿ç”¨@Beanæ³¨è§£å£°æ˜beanæ—¶å’Œä¸Šè¿°æ–¹å¼ç›¸åŒã€‚<br>ä¼šè¯å’Œè¯·æ±‚ä½œç”¨åŸŸï¼Œä½¿ç”¨åœºæ™¯æ˜¯webåº”ç”¨ï¼Œä»å‘½åç†è§£ï¼šä¼šè¯ä½œç”¨åŸŸæ˜¯æŒ‡è¯¥beançš„ç”Ÿå‘½å‘¨æœŸå’Œä¸€ä¸ªä¼šè¯çš„èµ·å§‹ä¿æŒä¸€è‡´ï¼Œæ¯”å¦‚å…¸å‹çš„ç”µå•†åœºæ™¯ï¼Œç”¨æˆ·ç™»å½•ï¼Œæœç´¢å•†å“ï¼ŒåŠ å…¥è´­ç‰©è½¦ï¼Œè´­ä¹°ï¼Œä»˜è´¹ï¼Œç»“æŸï¼Œè¿™ä¸ªæµç¨‹å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¼šè¯ï¼›è¯·æ±‚ä½œç”¨åŸŸæ˜¯æŒ‡ç”¨æˆ·ä»å‘èµ·ä¸€ä¸ªè¯·æ±‚å¼€å§‹ï¼Œåˆ°æœåŠ¡å™¨ç›¸åº”è¯¥è¯·æ±‚çš„è¿‡ç¨‹ã€‚è¿™ä¸¤ç§ä½œç”¨åŸŸçš„beanå°±æ˜¯åœ¨è¯¥åœºæ™¯ä¸‹ï¼Œéšç€ä¼šè¯&#x2F;è¯·æ±‚çš„ç”Ÿå‘½å‘¨æœŸå®ä¾‹åŒ–åˆ°é”€æ¯ï¼Œå…¸å‹çš„ï¼Œå¦‚ç”µå•†åœºæ™¯ä¸­çš„â€è´­ç‰©è½¦â€ã€‚</li>
</ol>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">
<span class="token keyword">protected</span> <span class="token class-name">BeanWrapper</span> <span class="token function">createBeanInstance</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">,</span> <span class="token class-name">RootBeanDefinition</span> mbd<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token comment">// Make sure bean class is actually resolved at this point.</span>
	<span class="token comment">// è§£æå‡º Class</span>
	<span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> beanClass <span class="token operator">=</span> <span class="token function">resolveBeanClass</span><span class="token punctuation">(</span>mbd<span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>beanClass <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token class-name">Modifier</span><span class="token punctuation">.</span><span class="token function">isPublic</span><span class="token punctuation">(</span>beanClass<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>mbd<span class="token punctuation">.</span><span class="token function">isNonPublicAccessAllowed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeanCreationException</span><span class="token punctuation">(</span>mbd<span class="token punctuation">.</span><span class="token function">getResourceDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> beanName<span class="token punctuation">,</span>
				<span class="token string">"Bean class isn't public, and non-public access not allowed: "</span> <span class="token operator">+</span> beanClass<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">// å¦‚æœå·¥å‚æ–¹æ³•ä¸ä¸ºç©ºï¼Œåˆ™æ˜¯ç”¨å·¥å‚æ–¹æ³•åˆå§‹åŒ–</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>mbd<span class="token punctuation">.</span><span class="token function">getFactoryMethodName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>
		<span class="token comment">// ç›¸å…³çŸ¥è¯†ç‚¹çœ‹å¦ä¸€ç¯‡æ–‡ç« å…³äºFactoryBeançš„</span>
		<span class="token keyword">return</span> <span class="token function">instantiateUsingFactoryMethod</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">// Shortcut when re-creating the same bean...</span>
	<span class="token comment">// å¦‚æœä¸æ˜¯ç¬¬ä¸€æ¬¡åˆ›å»ºï¼Œæ¯”å¦‚ç¬¬äºŒæ¬¡åˆ›å»º prototype beanã€‚</span>
	<span class="token comment">// è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä»ç¬¬ä¸€æ¬¡åˆ›å»ºçŸ¥é“ï¼Œé‡‡ç”¨æ— å‚æ„é€ å‡½æ•°ï¼Œè¿˜æ˜¯æ„é€ å‡½æ•°ä¾èµ–æ³¨å…¥ æ¥å®Œæˆå®ä¾‹åŒ–</span>
	<span class="token comment">// æ‰€ä»¥æ³¨é‡Šè¯´å«shortcut</span>
	<span class="token keyword">boolean</span> resolved <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token keyword">boolean</span> autowireNecessary <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>args <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">synchronized</span> <span class="token punctuation">(</span>mbd<span class="token punctuation">.</span>constructorArgumentLock<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>mbd<span class="token punctuation">.</span>resolvedConstructorOrFactoryMethod <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
				<span class="token comment">// æœ‰å·²ç»è§£æè¿‡çš„æ„é€ æ–¹æ³•</span>
				resolved <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
				autowireNecessary <span class="token operator">=</span> mbd<span class="token punctuation">.</span>constructorArgumentsResolved<span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token comment">// å¦‚æœå·²ç»è§£æè¿‡åˆ™ä½¿ç”¨è§£æå¥½çš„æ„é€ æ–¹æ³•ä¸éœ€è¦å†æ¬¡é”å®š</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>resolved<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>autowireNecessary<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			<span class="token comment">// æ„é€ æ–¹æ³•è‡ªåŠ¨æ³¨å…¥</span>
			<span class="token keyword">return</span> <span class="token function">autowireConstructor</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
			<span class="token comment">// é»˜è®¤æ„é€ æ–¹æ³•</span>
			<span class="token keyword">return</span> <span class="token function">instantiateBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">// Need to determine the constructor...</span>
	<span class="token comment">// åˆ¤æ–­æ˜¯å¦é‡‡ç”¨æœ‰å‚æ„é€ å‡½æ•°</span>
	<span class="token comment">// æ„é€ å™¨è‡ªåŠ¨è£…é…</span>
	<span class="token class-name">Constructor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> ctors <span class="token operator">=</span> <span class="token function">determineConstructorsFromBeanPostProcessors</span><span class="token punctuation">(</span>beanClass<span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ctors <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">||</span>
			mbd<span class="token punctuation">.</span><span class="token function">getResolvedAutowireMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">RootBeanDefinition</span><span class="token punctuation">.</span>AUTOWIRE_CONSTRUCTOR <span class="token operator">||</span>
			mbd<span class="token punctuation">.</span><span class="token function">hasConstructorArgumentValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token class-name">ObjectUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token function">autowireConstructor</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">,</span> ctors<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">// No special handling: simply use no-arg constructor.</span>
	<span class="token comment">// ä½¿ç”¨æ— å‚æ„é€ å™¨</span>
	<span class="token keyword">return</span> <span class="token function">instantiateBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h1 id="BeanFactory-vs-FactoryBean"><a href="#BeanFactory-vs-FactoryBean" class="headerlink" title="BeanFactory vs FactoryBean"></a>BeanFactory vs FactoryBean</h1><p>é¦–å…ˆï¼Œå®ƒä»¬éƒ½æ˜¯spring frameworké‡Œæ¯”è¾ƒé¡¶å±‚çš„æ¥å£ï¼šBeanFactoryå¯ä»¥çœ‹åšæœ€ç®€ç‰ˆçš„å®¹å™¨å½¢å¼ï¼Œä¹Ÿç»™å…·ä½“çš„IOCå®¹å™¨å®ç°æä¾›è§„èŒƒï¼Œæ¯”å¦‚ApplicationContextï¼›FactoryBeanä¸ºIOCå®¹å™¨ä¸­çš„Beanåˆ›å»ºæä¾›æ›´åŠ çµæ´»çš„æ–¹å¼ï¼Œé€šè¿‡ç»™Beançš„å®ç°åŠ ä¸Šä¸€ä¸ªç®€å•çš„å·¥å‚æ¨¡å¼å’Œè£…é¥°å™¨æ¨¡å¼ï¼Œä½¿å¾—å¯¹Beançš„é…ç½®æ›´åŠ ä¾¿æ·çµæ´»ã€‚<br>ä»å¦ä¸€ä¸ªè§’åº¦è®²ï¼Œä¸¤è€…éƒ½æ˜¯å·¥å‚ï¼ŒFactoryBeanæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªFactoryï¼Œå¹¶ä¸”å½’BeanFactoryç®¡ç†ã€‚</p>
<h2 id="BeanFactory"><a href="#BeanFactory" class="headerlink" title="BeanFactory"></a>BeanFactory</h2><p>ä»¥Factoryç»“å°¾çš„éƒ½æ˜¯å·¥å‚ç±»&#x2F;æ¥å£ã€‚å®ƒæ˜¯IOCå®¹å™¨çš„æ ¸å¿ƒæ¥å£ï¼Œå…¶èŒè´£åŒ…æ‹¬ï¼šå®ä¾‹åŒ–ã€å®šä½ã€é…ç½®åº”ç”¨ç¨‹åºä¸­çš„å¯¹è±¡ï¼Œä»¥åŠå»ºç«‹è¿™äº›å¯¹è±¡é—´çš„ä¾èµ–ã€‚FactoryBeanåªæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå¹¶éIOCå®¹å™¨çš„å…·ä½“å®ç°ï¼Œä½†springç»™å‡ºäº†å¾ˆå¤šç§å®ç°ï¼šApplicationContextã€DefaultListableBeanFactoryã€AnnotationConfigApplicationContextç­‰ã€‚<br>å…¶ä¸­AnnotationConfigApplicationContextæ˜¯ç›®å‰æ„å»ºå…·ä½“åº”ç”¨å¾ˆå¸¸ç”¨çš„ä¸€ä¸ªï¼Œå®ƒå®ç°å°†ä»¥æ³¨è§£æ–¹å¼æè¿°ç»„æˆåº”ç”¨çš„å¯¹è±¡å’Œå¯¹è±¡é—´çš„ä¾èµ–å…³ç³»ã€‚AnnotationConfigApplicationContextç±»å°†æŒæœ‰æ³¨è§£é…ç½®çš„æ‰€æœ‰å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¹¶ç”¨è¿™äº›å…ƒæ•°æ®æ„å»ºä¸€ä¸ªå®Œå…¨å¯é…ç½®çš„ç³»ç»Ÿæˆ–åº”ç”¨ã€‚<br>å†å¦‚ï¼ŒApplicationContextï¼Œæ´¾ç”Ÿè‡ªBeanFactoryï¼Œä»ç„¶æ˜¯ä¸€ä¸ªæ¥å£ï¼Œä½†å®ƒæä¾›ä¸€ç§æ›´é¢å‘æ¡†æ¶çš„æ–¹å¼å·¥ä½œï¼Œå¹¶ä¸”å¯¹ä¸Šä¸‹æ–‡è¿›è¡Œåˆ†å±‚å’Œå®ç°ç»§æ‰¿å…³ç³»ã€‚åŒæ—¶å®ƒè¿˜æ´¾ç”Ÿè‡ªMessageSourceã€ApplicationEventPublisherã€HierarchicalBeanFactoryã€ResourcePatternResolverç­‰æ¥å£ï¼Œä»è€Œæ‰©å……äº†ä»¥ä¸‹èƒ½åŠ›ï¼š</p>
<ul>
<li>MessageSource, æä¾›å›½é™…åŒ–çš„æ¶ˆæ¯è®¿é—®;</li>
<li>èµ„æºè®¿é—®ï¼Œå¦‚URLå’Œæ–‡ä»¶;</li>
<li>äº‹ä»¶ä¼ æ’­;</li>
<li>è½½å…¥å¤šä¸ªï¼ˆæœ‰ç»§æ‰¿å…³ç³»ï¼‰ä¸Šä¸‹æ–‡ ï¼Œä½¿å¾—æ¯ä¸€ä¸ªä¸Šä¸‹æ–‡éƒ½ä¸“æ³¨äºä¸€ä¸ªç‰¹å®šçš„å±‚æ¬¡ï¼Œæ¯”å¦‚åº”ç”¨çš„webå±‚;</li>
</ul>
<p>å…¶ä»–å„ç§BeanFactoryçš„å­æ¥å£ã€å­ç±»ä¹Ÿéƒ½æ˜¯æ‰©å±•äº†æŸç§åŠŸèƒ½çš„ç±»å·¥å‚ï¼Œç”¨äºç‰¹å®šåœºæ™¯ã€‚</p>
<h3 id="ä¸»è¦æ–¹æ³•ï¼š"><a href="#ä¸»è¦æ–¹æ³•ï¼š" class="headerlink" title="ä¸»è¦æ–¹æ³•ï¼š"></a>ä¸»è¦æ–¹æ³•ï¼š</h3><p><img src="/2018/06/03/spring/BeanFactory.png" alt="BeanFactory methods" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2018/06/03/spring/BeanFactory.png" class="lozad post-image"></p>
<h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><ul>
<li>ä»IOCå®¹å™¨ä¸­è·å–Bean(byName or byType)</li>
<li>æ£€ç´¢IOCå®¹å™¨ä¸­æ˜¯å¦åŒ…å«æŒ‡å®šçš„Bean</li>
<li>åˆ¤æ–­Beanæ˜¯å¦ä¸ºå•ä¾‹</li>
</ul>
<h2 id="FactoryBean"><a href="#FactoryBean" class="headerlink" title="FactoryBean"></a>FactoryBean</h2><p>é¦–å…ˆå®ƒæ˜¯ä¸€ä¸ªBeanï¼Œç”¨äºç”Ÿäº§&#x2F;ä¿®é¥°å…¶ä»–Beançš„å·¥å‚Beanï¼Œè¡¨ç°ä¸ºä¸€ä¸ªå·¥å‚çš„èŒè´£ï¼Œä¸»è¦ç”¨åˆ°å·¥å‚æ¨¡å¼ã€è£…é¥°å™¨æ¨¡å¼ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œspringå®¹å™¨æ‹…ä»»å·¥å‚çš„è§’è‰²ï¼Œä½†ä¹Ÿå­˜åœ¨ä¸€äº›åœºæ™¯ï¼Œæ¯”å¦‚æŸäº›Beanå®ä¾‹åŒ–è¿‡ç¨‹å¤æ‚ï¼Œéœ€è¦é…ç½®å¤§é‡ä¿¡æ¯ï¼Œæ­¤æ—¶å¯ä»¥æä¾›ä¸€ä¸ªFactoryBeanï¼Œç”¨å®ƒæ¥å®ç°å®šåˆ¶åŒ–çš„Beanå®ä¾‹åŒ–é€»è¾‘ã€‚FactoryBeanæ¥å£å¯¹äºSpringæ¡†æ¶æ¥è¯´æœ‰ç€é‡è¦åœ°ä½ï¼Œè‡ªèº«å°±æä¾›äº†70å¤šä¸ªFactoryBeançš„å®ç°ã€‚</p>
<h3 id="ä¸»è¦æ–¹æ³•ï¼š-1"><a href="#ä¸»è¦æ–¹æ³•ï¼š-1" class="headerlink" title="ä¸»è¦æ–¹æ³•ï¼š"></a>ä¸»è¦æ–¹æ³•ï¼š</h3><p><img src="/2018/06/03/spring/FactoryBean.png" alt="BeanFactory methods" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/2018/06/03/spring/FactoryBean.png" class="lozad post-image"></p>
<h3 id="ä½¿ç”¨åœºæ™¯-1"><a href="#ä½¿ç”¨åœºæ™¯-1" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><p>FactoryBeanåœ¨Springä¸­æœ€ä¸ºå…¸å‹çš„ä¸€ä¸ªåº”ç”¨å°±æ˜¯ç”¨æ¥åˆ›å»ºAOPçš„ä»£ç†å¯¹è±¡ã€‚AOPå®é™…ä¸Šæ˜¯Springåœ¨è¿è¡Œæ—¶åˆ›å»ºäº†ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªå¯¹è±¡æ˜¯åœ¨è¿è¡Œæ—¶åˆ›å»ºçš„ï¼Œè€Œä¸æ˜¯ä¸€å¼€å§‹å°±å®šä¹‰å¥½çš„ï¼Œè¿™å¾ˆç¬¦åˆå·¥å‚æ–¹æ³•æ¨¡å¼ã€‚æ›´å½¢è±¡åœ°è¯´ï¼ŒAOPä»£ç†å¯¹è±¡é€šè¿‡Javaçš„<strong>åå°„æœºåˆ¶</strong>ï¼Œåœ¨è¿è¡Œæ—¶åˆ›å»ºäº†ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œåœ¨ä»£ç†å¯¹è±¡çš„ç›®æ ‡æ–¹æ³•ä¸­æ ¹æ®ä¸šåŠ¡è¦æ±‚ç»‡å…¥äº†ç›¸åº”çš„æ–¹æ³•ã€‚è¿™ä¸ªå¯¹è±¡åœ¨Springä¸­å°±æ˜¯â€”â€”ProxyFactoryBeanã€‚</p>
<h1 id="IoC"><a href="#IoC" class="headerlink" title="IoC"></a>IoC</h1><p>Inversion of Controlï¼Œæ§åˆ¶åè½¬ï¼Œä¹Ÿç§°ä¾èµ–æ³¨å…¥ï¼ˆDIï¼ŒDependency Injectionï¼‰ã€‚åº”ç”¨å¯¹è±¡ä¹‹é—´çš„è§£è€¦ã€‚<br>é€šå¸¸æ‰€è®¨è®ºçš„ä¾èµ–æ³¨å…¥æ˜¯å°†ä¸€ä¸ªbeançš„å¼•ç”¨æ³¨å…¥åˆ°å¦ä¸€ä¸ªbeançš„å±æ€§æˆ–æ„é€ å™¨å‚æ•°ä¸­ï¼Œå³å°†ä¸€ä¸ªå¯¹è±¡ä¸å¦ä¸€ä¸ªå¯¹è±¡å…³è”èµ·æ¥ã€‚javaçš„åå°„æ˜¯å®ç°ä¾èµ–æ³¨å…¥çš„åº•å±‚æŠ€æœ¯ã€‚ä¾èµ–æ³¨å…¥æ˜¯Springå®¹å™¨çš„å†…æ ¸ï¼ŒAOPã€å£°æ˜å¼äº‹åŠ¡ç­‰åŠŸèƒ½ä¹Ÿéƒ½åŸºäºæ­¤ã€‚<br>Springæ˜¯ä¸€ç§å®¹å™¨æ¡†æ¶ï¼Œå®ƒå¸®åŠ©å®Œæˆç±»çš„åˆå§‹åŒ–å’Œè£…é…å·¥ä½œï¼Œè®©å¼€å‘è€…ä»è¿™äº›åº•å±‚å®ç°ç±»çš„å®ä¾‹åŒ–ã€ä¾èµ–å…³ç³»è£…é…ç­‰å·¥ä½œä¸­è§£è„±å‡ºæ¥ï¼Œä¸“æ³¨äºä¸šåŠ¡é€»è¾‘çš„å¼€å‘å·¥ä½œã€‚å®ƒé€šè¿‡é…ç½®æ–‡ä»¶æˆ–æ³¨è§£æè¿°ç±»å’Œç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œåˆ©ç”¨javaçš„åå°„åŠŸèƒ½å®ä¾‹åŒ–Beanå¹¶å»ºç«‹Beanä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œè‡ªåŠ¨å®Œæˆç±»çš„åˆå§‹åŒ–å’Œä¾èµ–æ³¨å…¥å·¥ä½œã€‚æ­¤å¤–ï¼ŒSpringè¿˜æä¾›Beanå®ä¾‹ç¼“å­˜ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€Beanå®ä¾‹ä»£ç†ã€äº‹ä»¶å‘å¸ƒã€èµ„æºè£…è½½ç­‰é«˜çº§æœåŠ¡ã€‚<br>BeanFactory(com.springframework.beans.factory.BeanFactory)æ˜¯Springæ¡†æ¶æœ€æ ¸å¿ƒçš„æ¥å£ï¼Œå®ƒæä¾›äº†é«˜çº§IoCçš„é…ç½®æœºåˆ¶ã€‚BeanFactoryä½¿ç®¡ç†ä¸åŒç±»å‹çš„javaå¯¹è±¡æˆä¸ºå¯èƒ½ï¼Œåº”ç”¨ä¸Šä¸‹æ–‡(com.springframework.context.ApplicationContext)å»ºç«‹åœ¨BeanFactoryåŸºç¡€ä¹‹ä¸Šï¼Œæä¾›äº†æ›´å¤šé¢å‘åº”ç”¨çš„åŠŸèƒ½ï¼Œå¦‚i18nå’Œæ¡†æ¶äº‹ä»¶ä½“ç³»ç­‰ï¼Œæ›´æ˜“äºåˆ›å»ºå®é™…åº”ç”¨ã€‚ä¸€èˆ¬ç§°BeanFactoryä¸ºIoCå®¹å™¨ï¼Œç§°ApplicationContextä¸ºåº”ç”¨ä¸Šä¸‹æ–‡ï¼Œæœ‰æ—¶ä¹Ÿç§°åè€…ä¸ºSpringå®¹å™¨ã€‚ç”¨é€”ä¸Šï¼ŒBeanFactoryæ˜¯Springæ¡†æ¶çš„åŸºç¡€è®¾æ–½ï¼Œé¢å‘Springæœ¬èº«ï¼›ApplicationContexté¢å‘ä½¿ç”¨Springæ¡†æ¶çš„å¼€å‘è€…ï¼Œå‡ ä¹æ‰€æœ‰çš„åº”ç”¨åœºåˆéƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨ApplicationContextè€Œéåº•å±‚çš„BeanFactoryã€‚</p>
<h2 id="BeanFactory-1"><a href="#BeanFactory-1" class="headerlink" title="BeanFactory"></a>BeanFactory</h2><p>å’Œæ™®é€šçš„å·¥å‚ç±»ä¸åŒï¼ŒBeanFactoryæ˜¯ç±»çš„é€šç”¨å·¥å‚ï¼Œå®ƒå¯ä»¥åˆ›å»ºå¹¶ç®¡ç†å„ç§ç±»çš„å¯¹è±¡ã€‚è¿™äº›å¯è¢«åˆ›å»ºå’Œç®¡ç†çš„å¯¹è±¡æœ¬èº«å¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ï¼Œä»…ä»…æ˜¯ä¸€ä¸ªPOJOï¼ŒSpringç§°è¿™äº›è¢«åˆ›å»ºå’Œç®¡ç†çš„javaå¯¹è±¡ä¸ºBeanã€‚javaBeanéœ€è¦æ»¡è¶³ä¸€å®šçš„è§„èŒƒï¼šæä¾›ä¸€ä¸ªé»˜è®¤ä¸å¸¦å‚æ•°çš„æ„é€ æ–¹æ³•ï¼›ä¸ä¾èµ–äºæŸä¸€ç‰¹å®šçš„å®¹å™¨ç­‰ã€‚Springæ‰€è¯´çš„Beanæ¯”javaBeanæ›´å®½æ³›ä¸€äº›ï¼Œæ‰€æœ‰å¯ä»¥è¢«Springå®¹å™¨å®ä¾‹åŒ–å¹¶ç®¡ç†çš„javaç±»éƒ½å¯ä»¥æˆä¸ºBeanã€‚<br><img src="https://raw.githubusercontent.com/lazy-snail/ImageHosting/master/wiki/BeanFactory-hierarchy.png" alt="BeanFactoryç±»ä½“ç³»ç»“æ„" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/lazy-snail/ImageHosting/master/wiki/BeanFactory-hierarchy.png" class="lozad post-image"></p>
<p>Springä¸ºBeanFactoryæä¾›äº†å¤šç§å®ç°ï¼Œå»ºè®®ä½¿ç”¨XmlBeanDefinitionReaderã€DefaultListableBeaFactoryã€‚BeanFactoryæ¥å£ä½äºç±»ç»“æ„æ ‘çš„é¡¶ç«¯ï¼Œæœ€ä¸»è¦çš„æ–¹æ³•å°±æ˜¯getBean(String beanName)ï¼Œè¯¥æ–¹æ³•ä»å®¹å™¨ä¸­è¿”å›ç‰¹å®šåç§°çš„beanã€‚BeanFactoryçš„åŠŸèƒ½é€šè¿‡å…¶å®ƒæ¥å£å¾—åˆ°ä¸æ–­æ‰©å±•ã€‚ä¸»è¦æœ‰ï¼š</p>
<ul>
<li>ListableBeanFactoryï¼šè¯¥æ¥å£å®šä¹‰äº†è®¿é—®å®¹å™¨ä¸­BeanåŸºæœ¬ä¿¡æ¯çš„ä¸€äº›æ–¹æ³•ï¼Œå¦‚æŸ¥çœ‹beançš„ä¸ªæ•°ã€è·å–æŸä¸€ç±»å‹beançš„é…ç½®åã€æŸ¥çœ‹å®¹å™¨ä¸­æ˜¯å¦åŒ…æ‹¬æŸä¸€beanç­‰ï¼›</li>
<li>HierarchicalBeanFactoryï¼šçˆ¶å­çº§è”IoCå®¹å™¨çš„æ¥å£ï¼Œå­å®¹å™¨å¯ä»¥é€šè¿‡æ¥å£æ–¹æ³•è®¿é—®çˆ¶å®¹å™¨ï¼›</li>
<li>ConfigurableBeanFactoryï¼šå¢å¼ºäº†IoCå®¹å™¨çš„å¯å®šåˆ¶æ€§ã€‚å®ƒå®šä¹‰äº†è®¾ç½®ç±»è£…è½½å™¨ã€å±æ€§ç¼–è¾‘å™¨ã€å®¹å™¨åˆå§‹åŒ–åç½®å¤„ç†å™¨ç­‰æ–¹æ³•ã€‚æ˜¯ä¸€ä¸ªé‡è¦çš„æ¥å£ï¼›</li>
<li>AutowireCapableBeanFactoryï¼šå®šä¹‰äº†å°†å®¹å™¨ä¸­çš„BeanæŒ‰æŸç§è§„åˆ™ï¼ˆå¦‚æŒ‰åå­—åŒ¹é…ã€æŒ‰ç±»å‹åŒ¹é…ç­‰ï¼‰è¿›è¡Œè‡ªåŠ¨è£…é…çš„æ–¹æ³•ï¼›</li>
<li>SingletonBeanRegistryï¼šå®šä¹‰äº†å…è®¸åœ¨è¿è¡ŒæœŸå‘å®¹å™¨æ³¨å†Œå•å®ä¾‹beançš„æ–¹æ³•ï¼›</li>
<li>BeanDefinitionRegistryï¼šSpringé…ç½®æ–‡ä»¶ä¸­æ¯ä¸€ä¸ª&lt;bean&gt;èŠ‚ç‚¹å…ƒç´ åœ¨Springå®¹å™¨ä¸­éƒ½é€šè¿‡ä¸€ä¸ªBeanDefinitionå¯¹è±¡è¡¨ç¤ºï¼Œå®ƒæè¿°äº†beançš„é…ç½®ä¿¡æ¯ã€‚è€Œè¯¥æ¥å£æä¾›å‘å®¹å™¨æ‰‹åŠ¨æ³¨å†ŒBeanDefinitionå¯¹è±¡çš„æ–¹æ³•ï¼›</li>
</ul>
<h3 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h3><p>XmlBeanDefinitionReaderé€šè¿‡Resourceè£…è½½Springé…ç½®ä¿¡æ¯å¹¶å¯åŠ¨IoCå®¹å™¨ï¼Œç„¶åå°±å¯ä»¥é€šè¿‡BeanFactory#getBean(beanName)ä»IoCå®¹å™¨è·å–beanã€‚é€šè¿‡BeanFactoryå¯åŠ¨IoCå®¹å™¨æ—¶ï¼Œå¹¶ä¸ä¼šåˆå§‹åŒ–é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„beanï¼Œåˆå§‹åŒ–åŠ¨ä½œå‘ç”Ÿåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶ã€‚å¯¹åº”å•å®ä¾‹çš„beanæ¥è¯´ï¼ŒBeanFactoryä¼šç¼“å­˜beanå®ä¾‹ï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡ä½¿ç”¨getBean()è·å–beanæ—¶ï¼Œå°†ç›´æ¥ä»IoCå®¹å™¨çš„ç¼“å­˜ä¸­è·å–ã€‚Springåœ¨DefaultSingletonBeanRegistryç±»ä¸­æä¾›äº†ä¸€ä¸ªç”¨äºç¼“å­˜å•å®ä¾‹beançš„ç¼“å­˜å™¨ï¼Œç”±HashMapå®ç°ï¼Œå•å®ä¾‹çš„beanä»¥beanNameä¸ºé”®ä¿å­˜åœ¨è¯¥mapä¸­ã€‚<br><strong>åˆå§‹åŒ–BeanFactoryæ—¶ï¼Œå¿…é¡»ä¸ºå…¶æä¾›ä¸€ç§æ—¥å¿—æ¡†æ¶ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</strong></p>
<h2 id="ApplicationContext"><a href="#ApplicationContext" class="headerlink" title="ApplicationContext"></a>ApplicationContext</h2><p>å¦‚æœè¯´BeanFactoryæ˜¯Springçš„â€å¿ƒè„â€œï¼Œé‚£ä¹ˆApplicationContextå°±æ˜¯å®Œæ•´çš„â€èº«èº¯â€œã€‚ApplicationContextç”±BeanFactoryæ´¾ç”Ÿè€Œæ¥ï¼Œæä¾›äº†æ›´å¤šé¢å‘å®é™…åº”ç”¨çš„åŠŸèƒ½ã€‚åœ¨BeanFactoryä¸­ï¼Œå¾ˆå¤šåŠŸèƒ½éœ€è¦ä»¥ç¼–ç¨‹çš„æ–¹å¼å®ç°ï¼Œè€Œåœ¨ApplicationContextä¸­åˆ™å¯ä»¥é€šè¿‡é…ç½®çš„æ–¹å¼å®ç°ã€‚<br>ApplicationContextçš„ä¸»è¦å®ç°ç±»æ˜¯ClassPathXmlApplicationContextå’ŒFileSystemXmlApplicationContextï¼Œå‰è€…é»˜è®¤ä»ç±»è·¯å¾„åŠ è½½é…ç½®æ–‡ä»¶ï¼Œåè€…é»˜è®¤ä»æ–‡ä»¶ç³»ç»Ÿä¸­è£…è½½é…ç½®æ–‡ä»¶ã€‚<br><img src="https://raw.githubusercontent.com/lazy-snail/ImageHosting/master/wiki/ApplicationContext-hierarchy.png" alt="ApplicationContextç±»ä½“ç³»ç»“æ„" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/lazy-snail/ImageHosting/master/wiki/ApplicationContext-hierarchy.png" class="lozad post-image"><br>å¯è§ï¼Œé™¤ç»§æ‰¿HierarchicalBeanFactoryå’ŒListableBeanFactoryæ¥å£å¤–ï¼ŒApplicationContextè¿˜é€šè¿‡å¤šä¸ªå…¶å®ƒæ¥å£æ‰©å±•BeanFactoryçš„åŠŸèƒ½ï¼š</p>
<ul>
<li>ApplicationEventPublisherï¼šè®©å®¹å™¨æ‹¥æœ‰å‘å¸ƒåº”ç”¨ä¸Šä¸‹æ–‡äº‹ä»¶çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬å®¹å™¨å¯åŠ¨äº‹ä»¶ã€å…³é—­äº‹ä»¶ç­‰ã€‚å®ç°äº†ApplicationListeneräº‹ä»¶ç›‘å¬æ¥å£çš„Beanå¯ä»¥æ¥æ”¶åˆ°å®¹å™¨äº‹ä»¶ï¼Œå¹¶å¯¹äº‹ä»¶è¿›è¡Œå“åº”å¤„ç†ã€‚åœ¨ApplicationContextæŠ½è±¡å®ç°ç±»AbstractApplicationContextä¸­å­˜åœ¨ä¸€ä¸ªApplicationEventMulticasterï¼Œå®ƒè´Ÿè´£ä¿å­˜æ‰€æœ‰çš„ç›‘å¬å™¨ï¼Œä»¥ä¾¿åœ¨å®¹å™¨äº§ç”Ÿä¸Šä¸‹æ–‡äº‹ä»¶æ—¶é€šçŸ¥è¿™äº›äº‹ä»¶ç›‘å¬è€…ï¼›</li>
<li>MessageSourceï¼šä¸ºåº”ç”¨æä¾›i18nå›½é™…åŒ–æ¶ˆæ¯è®¿é—®çš„åŠŸèƒ½ï¼›</li>
<li>ResourcePatternResolverï¼šæ‰€æœ‰ApplicationContextå®ç°ç±»éƒ½å®ç°äº†ç±»ä¼¼äºPathMatchingResourcePatternResolverçš„åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡å¸¦å‰ç¼€çš„anté£æ ¼çš„èµ„æºæ–‡ä»¶è·¯å¾„è£…è½½Springé…ç½®æ–‡ä»¶ï¼›</li>
<li>LifeCycleï¼šæä¾›start()ã€å’Œstop()ï¼Œä¸»è¦ç”¨äºæ§åˆ¶å¼‚æ­¥å¤„ç†è¿‡ç¨‹ã€‚åœ¨å…·ä½“ä½¿ç”¨æ—¶ï¼Œè¯¥æ¥å£åŒæ—¶è¢«ApplicationContextå®ç°ä»¥åŠå…·ä½“Beanå®ç°ï¼ŒApplicationContextä¼šå°†start&#x2F;stopçš„ä¿¡æ¯ä¼ é€’ç»™å®¹å™¨ä¸­æ‰€æœ‰å®ç°äº†è¯¥æ¥å£çš„Beanï¼Œä»¥è¾¾åˆ°ç®¡ç†å’Œæ§åˆ¶JMXã€ä»»åŠ¡è°ƒåº¦ç­‰ç›®çš„ã€‚</li>
</ul>
<p>ConfigurableApplicationContextæ‰©å±•äºApplicationContextï¼Œå®ƒæ–°å¢äº†ä¸¤ä¸ªä¸»è¦æ–¹æ³•ï¼šrefresh()ã€close()ï¼Œä½¿å¾—ApplicationContextå…·æœ‰å¯åŠ¨ã€åˆ·æ–°ã€å…³é—­åº”ç”¨ä¸Šä¸‹æ–‡çš„èƒ½åŠ›ã€‚åœ¨åº”ç”¨ä¸Šä¸‹æ–‡å…³é—­çš„æƒ…å†µä¸‹å¯ä»¥è°ƒç”¨refresh()å³å¯å¯åŠ¨åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œåœ¨å·²ç»å¯åŠ¨çš„çŠ¶æ€ä¸‹è°ƒç”¨refresh()åˆ™å¯æ¸…é™¤ç¼“å­˜å¹¶é‡æ–°è£…è½½é…ç½®ä¿¡æ¯ï¼Œè€Œè°ƒç”¨close()åˆ™å¯å…³é—­åº”ç”¨ä¸Šä¸‹æ–‡ã€‚è¿™äº›æ¥å£æ–¹æ³•ä¸ºå®¹å™¨çš„æ§åˆ¶ç®¡ç†å¸¦æ¥äº†ä¾¿åˆ©ï¼Œä½†ä½œä¸ºå¼€å‘è€…å¹¶ä¸éœ€è¦è¿‡å¤šå…³å¿ƒå®ƒä»¬ã€‚  </p>
<h3 id="åˆå§‹åŒ–-1"><a href="#åˆå§‹åŒ–-1" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h3><p>å’ŒBeanFactoryåˆå§‹åŒ–ç±»ä¼¼ï¼Œå¦‚æœé…ç½®æ–‡ä»¶æ”¾åœ¨ç±»è·¯å¾„ä¸‹ï¼Œä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ClassPathXmlApplicationContextå®ç°ï¼›å¦‚æœæ”¾åœ¨æ–‡ä»¶ç³»ç»Ÿè·¯å¾„ä¸‹ï¼Œåˆ™ä¼˜å…ˆè€ƒè™‘FileSystemXmlApplicationContextå®ç°ã€‚ä¹Ÿå¯ä»¥æŒ‡å®šä¸€ç»„é…ç½®æ–‡ä»¶ï¼ŒSpringä¼šå®Œæˆè‡ªåŠ¨æ•´åˆã€‚<br>è·å–ApplicationContextå®ä¾‹åï¼Œå°±å¯ä»¥åƒBeanFactoryä¸€æ ·è°ƒç”¨getBean(beaName)è¿”å›beanäº†ã€‚è€ŒApplicationContextçš„åˆå§‹åŒ–å’ŒBeanFactoryæœ‰ä¸€ä¸ªå¾ˆå¤§åŒºåˆ«ï¼šåè€…åœ¨åˆå§‹åŒ–å®¹å™¨æ—¶ï¼Œå¹¶æœªåˆå§‹åŒ–æ‰€æœ‰çš„Beanï¼Œç›´åˆ°ç¬¬ä¸€æ¬¡è®¿é—®æŸä¸ªBeanæ—¶æ‰å®ä¾‹åŒ–è¯¥ç›®æ ‡Beanï¼›è€ŒApplicationContextåˆ™åœ¨åˆå§‹åŒ–åº”ç”¨ä¸Šä¸‹æ–‡æ—¶å°±å®ä¾‹åŒ–æ‰€æœ‰å•å®ä¾‹çš„Beanã€‚å› æ­¤ï¼ŒApplicationContextçš„åˆå§‹åŒ–æ—¶é—´ä¼šæ¯”BeanFactoryç¨é•¿ã€‚<br>Springæ”¯æŒåŸºäºç±»æ³¨è§£çš„é…ç½®æ–¹å¼ï¼Œä¸»è¦åŠŸèƒ½æ¥è‡ªJavaConfigçš„å­é¡¹ç›®ã€‚ä¸€ä¸ªæ ‡æ³¨äº†@Configurationæ³¨è§£çš„POJOå³å¯æä¾›Springæ‰€éœ€çš„Beané…ç½®ä¿¡æ¯ã€‚è€Œä¸”Springä¸ºåŸºäºæ³¨è§£ç±»çš„é…ç½®ä¸“é—¨æä¾›äº†ApplicationContextå®ç°ç±»ï¼šAnnotationConfigApplicationContextï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨æ–¹æ³•å®ä¾‹åŒ–Beanï¼Œå¯åŠ¨å®¹å™¨å¹¶è£…é…Beanã€‚</p>
<h2 id="WebApplicationContext"><a href="#WebApplicationContext" class="headerlink" title="WebApplicationContext"></a>WebApplicationContext</h2><p>WebApplicationContextæ˜¯ä¸“é—¨ä¸ºWebåº”ç”¨å‡†å¤‡çš„ï¼Œå®ƒå…è®¸ä»ç›¸å¯¹äºWebæ ¹ç›®å½•çš„è·¯å¾„ä¸­è£…è½½é…ç½®æ–‡ä»¶å®Œæˆåˆå§‹åŒ–å·¥ä½œã€‚ä»WebApplicationContextä¸­å¯ä»¥è·å¾—ServletContextçš„å¼•ç”¨ï¼Œæ•´ä¸ªWebåº”ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡å°†ä½œä¸ºå±æ€§æ”¾ç½®åˆ°ServletContextä¸­ï¼Œä»¥ä¾¿Webåº”ç”¨ç¯å¢ƒå¯ä»¥è®¿é—®Springåº”ç”¨ä¸Šä¸‹æ–‡ã€‚Springä¸“é—¨ä¸ºæ­¤æä¾›äº†ä¸€ä¸ªå·¥å…·ç±»WebApplicationContextUtilsï¼Œé€šè¿‡è¯¥ç±»çš„getWebApplicationContext(ServletContext sc)ï¼Œå¯ä»¥ä»ServletContextä¸­è·å–WebApplicationContextå®ä¾‹ã€‚<br>åœ¨éWebåº”ç”¨çš„ç¯å¢ƒä¸‹ï¼ŒBeanåªæœ‰singletonã€prototypeä¸¤ç§ä½œç”¨åŸŸã€‚WebApplicationContextä¸ºBeanæ·»åŠ äº†ä¸‰ä¸ªæ–°çš„ä½œç”¨åŸŸï¼šrequestã€sessionã€global sessionã€‚<br><img src="https://raw.githubusercontent.com/lazy-snail/ImageHosting/master/wiki/WebApplicationContext-hierarchy.png" alt="WebApplicationContextç±»ä½“ç³»ç»“æ„" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/lazy-snail/ImageHosting/master/wiki/WebApplicationContext-hierarchy.png" class="lozad post-image"><br>ConfigurableWebApplicationContextæ‰©å±•äº†WebApplicationContextï¼Œå®ƒå…è®¸é€šè¿‡é…ç½®çš„æ–¹å¼å®ä¾‹åŒ–WebApplicationContextï¼ŒåŒæ—¶å®šä¹‰äº†ä¸¤ä¸ªé‡è¦æ–¹æ³•ï¼š</p>
<ul>
<li>setServletContext(ServletContext servletContext)ï¼šä¸ºSpringè®¾ç½®Webåº”ç”¨ä¸Šä¸‹æ–‡ï¼Œä»¥ä¾¿äºŒè€…æ•´åˆï¼›</li>
<li>setConfigLocations(String[] configLocations)ï¼šè®¾ç½®Springé…ç½®æ–‡ä»¶åœ°å€ï¼Œä¸€èˆ¬æ˜¯ç›¸å¯¹äºWebæ ¹ç›®å½•çš„åœ°å€ï¼Œå¦‚&#x2F;WEB-INF&#x2F;xxx-dao.xmlã€&#x2F;WEB-INF&#x2F;xxx-service.xmlã€‚ç”¨æˆ·ä¹Ÿå¯ä»¥ä½¿ç”¨å¸¦èµ„æºç±»å‹å‰ç¼€çš„åœ°å€ï¼Œå¦‚classpath:com&#x2F;baidu&#x2F;beans.xmlç­‰ã€‚</li>
</ul>
<h3 id="åˆå§‹åŒ–-2"><a href="#åˆå§‹åŒ–-2" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h3><p>WebApplicationContextçš„åˆå§‹åŒ–æ–¹å¼å’ŒBeanFactoryã€ApplicationContextæœ‰æ‰€åŒºåˆ«ï¼Œå› ä¸ºéœ€è¦ServletContextå®ä¾‹ã€‚å³å¿…é¡»åœ¨æ‹¥æœ‰Webå®¹å™¨çš„å‰æä¸‹æ‰èƒ½å®Œæˆå¯åŠ¨å·¥ä½œï¼Œå¯ä»¥åœ¨web.xmlä¸­é…ç½®è‡ªå¯åŠ¨çš„Servletæˆ–å®šä¹‰Webå®¹å™¨ç›‘å¬å™¨(ServletContextListener)ï¼ŒäºŒè€…å‡å¯å®Œæˆå¯åŠ¨Spring Webåº”ç”¨ä¸Šä¸‹æ–‡çš„å·¥ä½œã€‚Springä¸ºäºŒè€…å‡æä¾›äº†æ”¯æŒï¼š</p>
<ul>
<li>org.springframework.web.context.ContextLoaderServlet</li>
<li>org.springframework.web.context.ContextLoaderListener</li>
</ul>
<p>äºŒè€…å†…éƒ¨éƒ½å®ç°äº†å¯åŠ¨WebApplicationContextå®ä¾‹çš„é€»è¾‘ï¼Œåªéœ€æ ¹æ®Webå®¹å™¨çš„å…·ä½“æƒ…å†µé€‰æ‹©å…¶ä¸€å¹¶åœ¨web.xmlä¸­å®Œæˆé…ç½®å³å¯ã€‚</p>
<p><strong>WebApplicationContextåŒæ ·éœ€è¦æ—¥å¿—åŠŸèƒ½ï¼Œå¯ä»¥å°†Log4Jé…ç½®æ–‡ä»¶æ”¾ç½®åœ¨ç±»è·¯å¾„&#x2F;WEB-INF&#x2F;classesä¸‹ä»¥ä¾¿å¯åŠ¨Log4Jå¼•æ“ã€‚æˆ–åœ¨web.xmlæ–‡ä»¶æŒ‡å®šè‡ªå®šä¹‰çš„é…ç½®æ–‡ä»¶ä½ç½®ã€‚</strong></p>
<h2 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h2><p>åŸºæœ¬ä¸Šï¼Œ@Componentå’Œ@Serviceå…·æœ‰ç›¸åŒçš„æ•ˆæœï¼šè¿™ä¸¤ä¸ªæ³¨è§£éƒ½å‘Šè¯‰Springï¼Œæ³¨è§£çš„ç±»æ˜¯ä½¿ç”¨åŸºäºæ³¨è§£çš„é…ç½®å’Œç±»è·¯å¾„æ‰«æè¿›è¡Œè‡ªåŠ¨æ£€æµ‹æ—¶çš„å€™é€‰å¯¹è±¡ã€‚äº‹å®ä¸Šï¼Œ@Serviceæ˜¯@Componentçš„ä¸€ä¸ªç‰¹ä¾‹ï¼Œå®ƒè¡¨æ˜æ³¨è§£çš„ç±»æ­£åœ¨å‘åº”ç”¨ç¨‹åºä¸­çš„å…¶å®ƒå±‚æä¾›ä¸šåŠ¡æœåŠ¡ã€‚</p>
<h2 id="åå°„"><a href="#åå°„" class="headerlink" title="åå°„"></a>åå°„</h2><p>ä¸»è¦æ¶‰åŠjavaç±»åŠ è½½æœºåˆ¶ï¼Œå‚è€ƒã€Šæ·±å…¥ç†è§£javaè™šæ‹Ÿæœºã€‹ã€‚<br>æ¯ä¸ªç±»åœ¨jvmä¸­éƒ½æ‹¥æœ‰ä¸€ä¸ªå¯¹åº”çš„java.lang.Classå¯¹è±¡ï¼Œå³ç±»æè¿°å¯¹è±¡ï¼Œå®ƒæä¾›äº†ç±»ç»“æ„ä¿¡æ¯çš„æè¿°ã€‚æ•°ç»„ã€æšä¸¾ã€æ³¨è§£ã€åŸºæœ¬æ•°æ®ç±»å‹ã€voidç­‰éƒ½æœ‰å¯¹åº”çš„Classå¯¹è±¡ã€‚<br>Classåå°„å¯¹è±¡æè¿°ç±»è¯­ä¹‰ç»“æ„ï¼Œå¯ä»¥ä»Classå¯¹è±¡ä¸­è·å–æ„é€ æ–¹æ³•ã€æˆå‘˜å˜é‡ã€æ–¹æ³•ç±»ç­‰ç±»å…ƒç´ çš„åå°„å¯¹è±¡ï¼Œå¹¶ä»¥ç¼–ç¨‹çš„æ–¹å¼é€šè¿‡è¿™äº›åå°„å¯¹è±¡å¯¹ç›®æ ‡ç±»å¯¹è±¡è¿›è¡Œæ“ä½œã€‚è¿™äº›åå°„å¯¹è±¡ç±»åœ¨java.reflectåŒ…ä¸­å®šä¹‰ã€‚ä¸»è¦çš„åå°„ç±»ï¼š</p>
<ul>
<li>Constructorï¼šç±»çš„æ„é€ å‡½æ•°åå°„ç±»ã€‚é€šè¿‡Class#getConstructor()å¯ä»¥è·å–ç±»çš„æ‰€æœ‰æ„é€ æ–¹æ³•åå°„å¯¹è±¡æ•°ç»„ã€‚Constructorçš„ä¸€ä¸ªä¸»è¦æ–¹æ³•æ˜¯newInstance(Objectâ€¦ initargs)ï¼Œé€šè¿‡è¯¥æ–¹æ³•å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯¹è±¡ç±»çš„å®ä¾‹ï¼Œç›¸å½“äºnewå…³é”®å­—ã€‚</li>
<li>Methodï¼šç±»æ–¹æ³•çš„åå°„ç±»ã€‚é€šè¿‡Class#getDeclaredMethods()å¯ä»¥è·å–ç±»çš„æ‰€æœ‰æ–¹æ³•åå°„ç±»å¯¹è±¡æ•°ç»„Method[]ã€‚Methodä¸»è¦çš„æ–¹æ³•æœ‰ï¼š<ul>
<li>invoke(Object obj, Objectâ€¦ args)ï¼›</li>
<li>Class getReturnType()ï¼šè·å–æ–¹æ³•çš„è¿”å›å€¼ç±»å‹ï¼›</li>
<li>Class[] getParameterTypes()ï¼šè·å–æ–¹æ³•çš„å…¥å‚ç±»å‹æ•°ç»„ï¼›</li>
<li>Annotation[][] getParameterAnnotations()ï¼šè·å–æ–¹æ³•çš„æ³¨è§£ä¿¡æ¯ã€‚</li>
</ul>
</li>
<li>Fieldï¼šç±»çš„æˆå‘˜å˜é‡çš„åå°„ç±»ã€‚é€šè¿‡Class#getDeclaredFields()å¯ä»¥è·å–ç±»çš„æˆå‘˜å˜é‡åå°„å¯¹è±¡æ•°ç»„ï¼Œé€šè¿‡Class#getDeclaredField(String name)åˆ™å¯ä»¥è·å¾—æŸä¸ªç‰¹å®šåç§°çš„æˆå‘˜å˜é‡åå°„å¯¹è±¡ã€‚å…¶æœ€ä¸»è¦çš„æ–¹æ³•æ˜¯set(Object obj, Object value)ï¼Œé€šè¿‡valueä¸ºæ“ä½œå¯¹è±¡objèµ‹å€¼ã€‚å¦‚æœæˆå‘˜å˜é‡ä¸ºåŸºç¡€ç±»å‹ï¼Œåˆ™å¯ä»¥ä½¿ç”¨Fieldç±»ä¸­æä¾›çš„å¸¦ç±»å‹åçš„å€¼è®¾ç½®æ–¹æ³•ï¼Œå¦‚setBoolean(Object obj, boolean value)ã€‚</li>
</ul>
<p>æ­¤å¤–ï¼Œjavaè¿˜ä¸ºåŒ…æä¾›äº†Packageåå°„ç±»ï¼Œä¸ºæ³¨è§£æä¾›äº†AnnotatedElementåå°„ç±»ã€‚æ€»ä¹‹ï¼Œjavaçš„åå°„ä½“ç³»ä¿è¯äº†å¯ä»¥é€šè¿‡ç¨‹åºåŒ–çš„æ–¹å¼è®¿é—®ç›®æ ‡ç±»ä¸­æ‰€æœ‰çš„å…ƒç´ ï¼Œå¯¹äºprivateæˆ–protectecæˆå‘˜å˜é‡å’Œæ–¹æ³•ï¼Œåªè¦jvmçš„å®‰å…¨æœºåˆ¶å…è®¸ï¼Œä¹Ÿå¯ä»¥é€šè¿‡åå°„è¿›è¡Œè°ƒç”¨ï¼Œæ­¤æ—¶éœ€è¦é€šè¿‡setAccessible(boolean access)å–æ¶ˆjavaè¯­è¨€æ£€æŸ¥ï¼Œå¦åˆ™å°†æŠ›å‡ºIllegalAccessExceptionã€‚å¦‚æœjvmå®‰å…¨ç®¡ç†å™¨è®¾ç½®äº†ç›¸åº”çš„å®‰å…¨æœºåˆ¶ï¼Œè°ƒç”¨ä¼šæŠ›å‡ºSecurityExceptionã€‚</p>
<h1 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h1><p>AOPæ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³ã€‚<br>æ—¥å¿—ã€å®‰å…¨ã€äº‹åŠ¡ç®¡ç†ã€ç¼“å­˜ç­‰ï¼Œåœ¨è½¯ä»¶ç³»ç»Ÿä¸­éƒ½æ˜¯éå¸¸é‡è¦çš„åŠŸèƒ½ï¼Œä½†å®ƒä»¬ä¸è½¯ä»¶æœ¬èº«æ‰€å…³æ³¨çš„â€œåŠŸèƒ½â€å³ä¸šåŠ¡é€»è¾‘ï¼Œä»æ¦‚å¿µä¸Šè®²ï¼ˆåº”è¯¥ï¼‰æ˜¯åˆ†ç¦»çš„ï¼Œç„¶è€Œå®ƒä»¬æ•£å¸ƒåµŒå…¥åœ¨ä¸šåŠ¡é€»è¾‘ä¹‹ä¸­ï¼Œéœ€è¦åœ¨ä¸šåŠ¡é€»è¾‘åŠŸèƒ½æ‰§è¡Œçš„è¿‡ç¨‹ä¸­è¢«åŠ¨åœ°è§¦å‘ã€‚è¿™äº›åŠŸèƒ½é€šå¸¸è¢«ç§°ä¸ºæ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆcross-cutting concernï¼‰ã€‚æŠŠè¿™äº›æ¨ªåˆ‡å…³æ³¨ç‚¹ä¸ä¸šåŠ¡é€»è¾‘ç›¸åˆ†ç¦»å°±æ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼ŒAspect Oriented Programmingï¼‰ï¼Œå®ç°æ¨ªåˆ‡å…³æ³¨ç‚¹ä¸å®ƒä»¬æ‰€å½±å“çš„å¯¹è±¡ä¹‹é—´çš„è§£è€¦ã€‚<br>é‡ç”¨é€šç”¨åŠŸèƒ½çš„æ–¹æ¡ˆä¸€èˆ¬ä¸ºç»§æ‰¿æˆ–å§”æ‰˜ï¼Œè€Œåˆ‡é¢æ˜¯å¦ä¸€ç§å®ç°è¯¥ç›®æ ‡çš„æ–¹æ¡ˆã€‚åœ¨ä½¿ç”¨é¢å‘åˆ‡é¢ç¼–ç¨‹æ—¶ï¼Œä»ç„¶åœ¨ä¸€ä¸ªåœ°æ–¹å®šä¹‰é€šç”¨åŠŸèƒ½ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å£°æ˜çš„æ–¹å¼å®šä¹‰è¿™ä¸ªåŠŸèƒ½è¦ä»¥åˆä½•ç§æ–¹å¼åœ¨ä½•å¤„åº”ç”¨ï¼Œè€Œæ— éœ€ä¿®æ”¹å—å½±å“çš„ç±»ã€‚æ¨ªåˆ‡å…³æ³¨ç‚¹å¯ä»¥è¢«æ¨¡å—åŒ–ä¸ºç‰¹æ®Šçš„ç±»ï¼Œè¿™äº›ç±»è¢«ç§°ä¸ºåˆ‡é¢ï¼ˆaspectï¼‰ã€‚æœ‰ä¸¤ä¸ªå¥½å¤„ï¼š</p>
<ol>
<li>æ¯ä¸ªå…³æ³¨ç‚¹éƒ½é›†ä¸­åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œè€Œä¸æ˜¯åˆ†æ•£åœ¨å¤šå¤„ä»£ç ä¸­ï¼›</li>
<li>æœåŠ¡æ¨¡å—æ›´åŠ ç®€æ´ï¼Œå› ä¸ºå®ƒä»¬éƒ½åªåŒ…å«ä¸»è¦å…³æ³¨ç‚¹ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰çš„ä»£ç ï¼Œè€Œæ¬¡è¦å…³æ³¨çš„ä»£ç è¢«è½¬ç§»åˆ°åˆ‡é¢ä¸­ã€‚</li>
</ol>
<h2 id="ç›¸å…³æœ¯è¯­"><a href="#ç›¸å…³æœ¯è¯­" class="headerlink" title="ç›¸å…³æœ¯è¯­"></a>ç›¸å…³æœ¯è¯­</h2><h3 id="å¢å¼º-advice"><a href="#å¢å¼º-advice" class="headerlink" title="å¢å¼º advice"></a>å¢å¼º advice</h3><p>åˆ‡é¢çš„å·¥ä½œè¢«ç§°ä¸ºå¢å¼ºã€‚<br>å¢å¼ºå®šä¹‰äº†åˆ‡é¢æ˜¯ä»€ä¹ˆä»¥åŠä½•æ—¶ä½¿ç”¨ï¼ˆwhat and whenï¼‰ã€‚é™¤äº†æè¿°åˆ‡é¢è¦å®Œæˆçš„å·¥ä½œï¼Œå¢å¼ºè¿˜è§£å†³äº†ä½•æ—¶æ‰§è¡Œè¿™ä¸ªå·¥ä½œçš„é—®é¢˜ï¼šå®ƒåº”è¯¥åº”ç”¨åœ¨æŸä¸ªæ–¹æ³•è¢«è°ƒç”¨ä¹‹å‰ã€ä¹‹åè¿˜æ˜¯åªåœ¨æ–¹æ³•æŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œç­‰ã€‚<br>Springåˆ‡é¢æ”¯æŒ5ç§ç±»å‹çš„å¢å¼ºï¼š</p>
<ol>
<li>å‰ç½®å¢å¼ºï¼ˆBeforeï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•è¢«è°ƒç”¨ä¹‹å‰è°ƒç”¨å¢å¼ºåŠŸèƒ½ï¼›</li>
<li>åç½®å¢å¼ºï¼ˆAfterï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•å®Œæˆä¹‹åè°ƒç”¨å¢å¼ºï¼Œæ­¤æ—¶ä¸ä¼šå…³å¿ƒæ–¹æ³•çš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼›</li>
<li>ç¯ç»•å¢å¼ºï¼ˆAroundï¼‰ï¼šåœ¨è¢«å¢å¼ºæ–¹æ³•è°ƒç”¨å‰åéƒ½æ‰§è¡Œè‡ªå®šä¹‰çš„è¡Œä¸ºï¼›</li>
<li>è¿”å›å¢å¼ºï¼ˆAfter-returningï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•æˆåŠŸæ‰§è¡Œä¹‹åè°ƒç”¨å¢å¼ºï¼›</li>
<li>å¼‚å¸¸å¢å¼ºï¼ˆAfter-throwingï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ä¹‹åè°ƒç”¨å¢å¼ºã€‚</li>
</ol>
<h3 id="è¿æ¥ç‚¹-join-point"><a href="#è¿æ¥ç‚¹-join-point" class="headerlink" title="è¿æ¥ç‚¹ join point"></a>è¿æ¥ç‚¹ join point</h3><p>åº”ç”¨å¢å¼ºçš„æ—¶æœºï¼Œè¢«ç§°ä¸ºè¿æ¥ç‚¹ã€‚è¿æ¥ç‚¹æ˜¯åœ¨åº”ç”¨æ‰§è¡Œè¿‡ç¨‹ä¸­èƒ½å¤Ÿæ’å…¥åˆ‡é¢çš„ä¸€ä¸ªç‚¹ï¼Œè¿™ä¸ªç‚¹å¯ä»¥æ˜¯è°ƒç”¨æ–¹æ³•æ—¶ã€æŠ›å‡ºå¼‚å¸¸æ—¶ã€ç”šè‡³ä¿®æ”¹ä¸€ä¸ªå­—æ®µæ—¶ï¼Œåˆ‡é¢ä»£ç å¯ä»¥åˆ©ç”¨è¿™äº›ç‚¹æ’å…¥åˆ°åº”ç”¨çš„æ­£å¸¸æµç¨‹ä¹‹ä¸­ï¼Œå¹¶æ·»åŠ æ–°çš„è¡Œä¸ºã€‚</p>
<h3 id="åˆ‡ç‚¹-pointcut"><a href="#åˆ‡ç‚¹-pointcut" class="headerlink" title="åˆ‡ç‚¹ pointcut"></a>åˆ‡ç‚¹ pointcut</h3><p>å¢å¼ºå®šä¹‰äº†åˆ‡é¢çš„â€œwhatâ€å’Œâ€œwhenâ€ï¼Œåˆ‡ç‚¹å®šä¹‰äº†åˆ‡é¢çš„â€œwhereâ€ï¼Œåˆ‡ç‚¹çš„å®šä¹‰ä¼šåŒ¹é…å¢å¼ºæ‰€è¦ç»‡å…¥çš„ä¸€ä¸ªæˆ–å¤šä¸ªè¿æ¥ç‚¹ã€‚é€šå¸¸ä½¿ç”¨æ˜ç¡®çš„ç±»å’Œæ–¹æ³•åï¼Œæˆ–åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼å®šä¹‰æ‰€åŒ¹é…çš„ç±»å’Œæ–¹æ³•åæ¥æŒ‡å®šè¿™äº›åˆ‡ç‚¹ã€‚</p>
<h3 id="åˆ‡é¢-aspect"><a href="#åˆ‡é¢-aspect" class="headerlink" title="åˆ‡é¢ aspect"></a>åˆ‡é¢ aspect</h3><p>åˆ‡é¢æ˜¯å¢å¼ºå’Œåˆ‡ç‚¹çš„ç»“åˆã€‚å¢å¼ºå’Œåˆ‡ç‚¹å…±åŒå®šä¹‰äº†åˆ‡é¢çš„å…¨éƒ¨å†…å®¹â€”â€”å®ƒæ˜¯ä»€ä¹ˆï¼Œåœ¨ä½•æ—¶ä½•å¤„å®Œæˆå…¶åŠŸèƒ½ã€‚ </p>
<h3 id="å¼•å…¥-introduction"><a href="#å¼•å…¥-introduction" class="headerlink" title="å¼•å…¥ introduction"></a>å¼•å…¥ introduction</h3><p>å¼•å…¥å…è®¸å‘ç°æœ‰çš„ç±»æ·»åŠ æ–°æ–¹æ³•æˆ–å±æ€§ï¼Œä»è€Œåœ¨æ— éœ€ä¿®æ”¹ç°æœ‰ç±»çš„æƒ…å†µä¸‹ï¼Œè®©è¿™äº›ç±»å…·æœ‰æ–°çš„è¡Œä¸ºå’ŒçŠ¶æ€ã€‚æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¢å¼ºã€‚</p>
<h3 id="ç»‡å…¥-weaving"><a href="#ç»‡å…¥-weaving" class="headerlink" title="ç»‡å…¥ weaving"></a>ç»‡å…¥ weaving</h3><p>æŠŠåˆ‡é¢åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡å¹¶åˆ›å»ºæ–°çš„ä»£ç†å¯¹è±¡çš„è¿‡ç¨‹ã€‚åˆ‡é¢åœ¨æŒ‡å®šçš„è¿æ¥ç‚¹è¢«ç»‡å…¥åˆ°ç›®æ ‡å¯¹è±¡ä¸­ï¼Œåœ¨ç›®æ ‡å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸé‡Œæœ‰å¤šä¸ªç‚¹å¯ä»¥è¿›è¡Œç»‡å…¥ï¼š</p>
<ul>
<li>ç¼–è¯‘æœŸï¼šåˆ‡é¢åœ¨ç›®æ ‡ç±»ç¼–è¯‘æ—¶è¢«ç»‡å…¥ã€‚è¿™ç§æ–¹å¼éœ€è¦ç‰¹æ®Šçš„ç¼–è¯‘å™¨ã€‚AspectJçš„ç»‡å…¥ç¼–è¯‘å™¨å°±æ˜¯ä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢çš„ã€‚</li>
<li>ç±»åŠ è½½æœŸï¼šåˆ‡é¢åœ¨ç›®æ ‡ç±»åŠ è½½åˆ°JVMæ—¶è¢«ç»‡å…¥ã€‚è¿™ç§æ–¹å¼éœ€è¦ç‰¹æ®Šçš„ç±»åŠ è½½å™¨ï¼Œå®ƒå¯ä»¥åœ¨ç›®æ ‡ç±»è¢«å¼•å…¥åº”ç”¨ä¹‹å‰å¢å¼ºè¯¥ç›®æ ‡ç±»çš„å­—èŠ‚ç ã€‚AspectJ 5çš„åŠ è½½æ—¶ç»‡å…¥ï¼ˆload-time weavingï¼ŒLTWï¼‰å°±æ”¯æŒä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢ã€‚</li>
<li>è¿è¡ŒæœŸï¼šåˆ‡é¢åœ¨åº”ç”¨è¿è¡Œçš„æŸä¸ªæ—¶åˆ»è¢«ç»‡å…¥ã€‚ä¸€èˆ¬ï¼Œåœ¨ç»‡å…¥åˆ‡é¢æ—¶ï¼ŒAOPå®¹å™¨ä¼šä¸ºç›®æ ‡å¯¹è±¡åŠ¨æ€åœ°åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚Spring AOPå°±æ˜¯ä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢çš„ã€‚</li>
</ul>
<h2 id="Springç§çš„AOP"><a href="#Springç§çš„AOP" class="headerlink" title="Springç§çš„AOP"></a>Springç§çš„AOP</h2><p>AOPæ¡†æ¶åœ¨è¿æ¥ç‚¹æ¨¡å‹ä¸Šæœ‰å¼ºå¼±ä¹‹åˆ†ï¼Œæ¯”å¦‚æœ‰äº›å…è®¸åœ¨å­—æ®µä¿®é¥°ç¬¦çº§åˆ«åº”ç”¨å¢å¼ºï¼Œæœ‰äº›åªæ”¯æŒä¸æ–¹æ³•è°ƒç”¨ç›¸å…³çš„è¿æ¥ç‚¹ã€‚æ­¤å¤–ï¼Œæ¡†æ¶ç»‡å…¥åˆ‡é¢çš„æ–¹å¼å’Œæ—¶æœºä¹Ÿæœ‰æ‰€ä¸åŒã€‚ä½†æ— è®ºå¦‚ä½•ï¼Œ<strong>åˆ›å»ºåˆ‡ç‚¹æ¥å®šä¹‰åˆ‡é¢æ‰€ç»‡å…¥çš„è¿æ¥ç‚¹æ˜¯AOPæ¡†æ¶çš„åŸºæœ¬åŠŸèƒ½ã€‚</strong></p>
<p>Springæä¾›4ç§ç±»å‹çš„AOPæ”¯æŒï¼š</p>
<ul>
<li>åŸºäºä»£ç†çš„ç»å…¸Spring AOPï¼ˆç°åœ¨æ¥çœ‹ç¬¨é‡ä¸”å¤æ‚ï¼‰ï¼›</li>
<li>çº¯POJOåˆ‡é¢ï¼ˆéœ€è¦xmlé…ç½®ï¼‰ï¼›</li>
<li>@AspectJæ³¨è§£é©±åŠ¨çš„åˆ‡é¢ï¼ˆæœ¬è´¨ä¸Šä¾ç„¶æ˜¯åŸºäºä»£ç†çš„AOPï¼‰ï¼›</li>
<li>æ³¨å…¥å¼AspectJåˆ‡é¢ï¼ˆåŸºæœ¬çš„æ–¹æ³•è°ƒç”¨çº§åˆ«åˆ‡é¢æ»¡è¶³ä¸äº†éœ€æ±‚æ—¶ï¼‰ã€‚</li>
</ul>
<p>å‰ä¸‰ç§éƒ½æ˜¯Spring AOPå®ç°çš„å˜ä½“ã€‚Spring AOPæ„å»ºåœ¨<strong>åŠ¨æ€ä»£ç†</strong>åŸºç¡€ä¹‹ä¸Šï¼Œå› æ­¤ï¼ŒSpringå¯¹AOPçš„æ”¯æŒå±€é™äºæ–¹æ³•æ‹¦æˆªã€‚</p>
<h2 id="è¿è¡Œæ—¶å¢å¼ºå¯¹è±¡"><a href="#è¿è¡Œæ—¶å¢å¼ºå¯¹è±¡" class="headerlink" title="è¿è¡Œæ—¶å¢å¼ºå¯¹è±¡"></a>è¿è¡Œæ—¶å¢å¼ºå¯¹è±¡</h2><p>é€šè¿‡åœ¨ä»£ç†ç±»ä¸­åŒ…è£¹åˆ‡é¢ï¼ŒSpringåœ¨è¿è¡ŒæœŸæŠŠåˆ‡é¢ç»‡å…¥åˆ°Springç®¡ç†çš„beanä¸­ã€‚ä»£ç†ç±»å°è£…äº†ç›®æ ‡ç±»ï¼Œæ‹¦æˆªè¢«å¢å¼ºæ–¹æ³•çš„è°ƒç”¨ï¼Œå†æŠŠè°ƒç”¨è½¬å‘ç»™çœŸæ­£çš„ç›®æ ‡beanã€‚å³ä»£ç†ç±»å¤„ç†æ–¹æ³•çš„è°ƒç”¨ï¼Œæ‰§è¡Œé¢å¤–çš„åˆ‡é¢é€»è¾‘ï¼Œå¹¶è°ƒç”¨ç›®æ ‡æ–¹æ³•ã€‚<br><img  srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://img-blog.csdn.net/20160505123413155" class="lozad post-image"src="https://img-blog.csdn.net/20160505123413155"><br>Springè¿è¡Œæ—¶æ‰åˆ›å»ºä»£ç†å¯¹è±¡ã€‚</p>
<h2 id="åˆ‡ç‚¹ç±»å‹"><a href="#åˆ‡ç‚¹ç±»å‹" class="headerlink" title="åˆ‡ç‚¹ç±»å‹"></a>åˆ‡ç‚¹ç±»å‹</h2><p>Springæä¾›6ç§ç±»å‹çš„åˆ‡ç‚¹ï¼š</p>
<ul>
<li>é™æ€æ–¹æ³•åˆ‡ç‚¹ï¼šorg.springframework.aop.support.StaticMethodMatcherPointcutæ˜¯é™æ€æ–¹æ³•åˆ‡ç‚¹çš„æŠ½è±¡åŸºç±»ï¼Œé»˜è®¤æƒ…å†µä¸‹å®ƒå¯ä»¥åŒ¹é…æ‰€æœ‰çš„ç±»ã€‚åŒ…å«ä¸¤ä¸ªä¸»è¦çš„å­ç±»ï¼šNameMatchMethodPointcut &amp; AbstractRegexpMethodPointcutï¼Œå‰è€…æä¾›ç®€å•çš„å­—ç¬¦ä¸²åŒ¹é…æ–¹æ³•ç­¾åï¼Œåè€…ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æ–¹æ³•ç­¾åï¼›</li>
<li>åŠ¨æ€æ–¹æ³•åˆ‡ç‚¹ï¼šorg.springframework.aop.support.DynamicMethodMatcherPointcutæ˜¯åŠ¨æ€æ–¹æ³•åˆ‡ç‚¹çš„æŠ½è±¡åŸºç±»ï¼Œé»˜è®¤æƒ…å†µä¸‹åŒ¹é…æ‰€æœ‰çš„ç±»ï¼›</li>
<li>æ³¨è§£åˆ‡ç‚¹ï¼šorg.springframework.aop.support.annotation.AnnotationMatchingPointcutçš„å®ç°ç±»è¡¨ç¤ºæ³¨è§£åˆ‡ç‚¹ï¼Œæ”¯æŒåœ¨Beanä¸­ç›´æ¥é€šè¿‡java5.0æ³¨è§£æ ‡ç­¾å®šä¹‰çš„åˆ‡ç‚¹ï¼›</li>
<li>è¡¨è¾¾å¼åˆ‡ç‚¹ï¼šorg.springframework.aop.support.ExpressionPointcutæ¥å£ä¸»è¦æ˜¯ä¸ºäº†æ”¯æŒAspectJåˆ‡ç‚¹è¡¨è¾¾å¼è¯­æ³•è€Œå®šä¹‰çš„æ¥å£ï¼›</li>
<li>æµç¨‹åˆ‡ç‚¹ï¼šorg.springframework.aop.support.ControlFlowPointcutå®ç°ç±»è¡¨ç¤ºæ§åˆ¶æµç¨‹åˆ‡ç‚¹ã€‚ControlFlowPointcutæ˜¯ä¸€ç±»ç‰¹æ®Šçš„åˆ‡ç‚¹ï¼Œå®ƒæ ¹æ®ç¨‹åºæ‰§è¡Œå †æ ˆçš„ä¿¡æ¯æŸ¥çœ‹ç›®æ ‡æ–¹æ³•</li>
</ul>

  </div>
  <div>
    
      <div 
        class="post-note note-warning copyright" 
        style="margin-top: 42px">
        <p>
          <span style="font-weight: bold;">ä½œè€…ï¼š</span><a 
            target="_blank" 
            rel="nofollow noopener noreferrer" 
            href="/about">
            Neil
          </a>
        </p>
        <p>
          <span style="font-weight: bold;">æ–‡ç« é“¾æ¥ï¼š</span><a 
            target="_blank" 
            rel="nofollow noopener noreferrer" 
            href="https://lazy-snail.github.io/2018/06/03/spring/">
            https://lazy-snail.github.io/2018/06/03/spring/
          </a>
        </p>
        <p><span style="font-weight: bold;">ç‰ˆæƒå£°æ˜ï¼š</span>è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</p>
      </div>
    
  </div>
</article>
<div class="nav">
  
    <div class="nav-item-prev">
      <a 
        href="/2018/06/03/os/" 
        class="nav-link">
        <i class="iconfont icon-left nav-prev-icon"></i>
        <div>
          <div class="nav-label">Prev</div>
          
            <div class="nav-title">os </div>
          
        </div>
      </a>
    </div>
  
  
    <div class="nav-item-next">
      <a 
        href="/2018/03/29/algs/" 
        class="nav-link">
        <div>
          <div class="nav-label">Next</div>
          
            <div class="nav-title">algs </div>
          
        </div>
        <i class="iconfont icon-right nav-next-icon"></i>
      </a>
    </div>
  
</div>

<div 
  class="card card-content toc-card" 
  id="mobiletoc">
  <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>TOC
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6"><span class="toc-number">1.</span> <span class="toc-text">ç»„ä»¶</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringBoot%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">SpringBootå¯åŠ¨è¿‡ç¨‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86%E8%BF%87%E7%A8%8B"><span class="toc-number">3.</span> <span class="toc-text">è¯·æ±‚å¤„ç†è¿‡ç¨‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8%E5%92%8C%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-number">4.</span> <span class="toc-text">è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#filter"><span class="toc-number">4.1.</span> <span class="toc-text">filter</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">4.1.1.</span> <span class="toc-text">åº”ç”¨åœºæ™¯</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#interceptor"><span class="toc-number">4.2.</span> <span class="toc-text">interceptor</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-1"><span class="toc-number">4.2.1.</span> <span class="toc-text">åº”ç”¨åœºæ™¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%8E%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-number">5.</span> <span class="toc-text">åå¤„ç†å™¨</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E5%99%A8"><span class="toc-number">6.</span> <span class="toc-text">ç›‘å¬å™¨</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E7%BA%A7%E7%BC%93%E5%AD%98"><span class="toc-number">7.</span> <span class="toc-text">ä¸‰çº§ç¼“å­˜</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#bean%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">8.</span> <span class="toc-text">beanç”Ÿå‘½å‘¨æœŸ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E5%AD%97%E6%8F%8F%E8%BF%B0"><span class="toc-number">8.1.</span> <span class="toc-text">æ–‡å­—æè¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanFactory%E4%B8%ADBean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">8.2.</span> <span class="toc-text">BeanFactoryä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ApplicationContext%E4%B8%ADBean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">8.3.</span> <span class="toc-text">ApplicationContextä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">8.4.</span> <span class="toc-text">ä½œç”¨åŸŸ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BeanFactory-vs-FactoryBean"><span class="toc-number">9.</span> <span class="toc-text">BeanFactory vs FactoryBean</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanFactory"><span class="toc-number">9.1.</span> <span class="toc-text">BeanFactory</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="toc-number">9.1.1.</span> <span class="toc-text">ä¸»è¦æ–¹æ³•ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">9.1.2.</span> <span class="toc-text">ä½¿ç”¨åœºæ™¯</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FactoryBean"><span class="toc-number">9.2.</span> <span class="toc-text">FactoryBean</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E6%96%B9%E6%B3%95%EF%BC%9A-1"><span class="toc-number">9.2.1.</span> <span class="toc-text">ä¸»è¦æ–¹æ³•ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-1"><span class="toc-number">9.2.2.</span> <span class="toc-text">ä½¿ç”¨åœºæ™¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#IoC"><span class="toc-number">10.</span> <span class="toc-text">IoC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanFactory-1"><span class="toc-number">10.1.</span> <span class="toc-text">BeanFactory</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">10.1.1.</span> <span class="toc-text">åˆå§‹åŒ–</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ApplicationContext"><span class="toc-number">10.2.</span> <span class="toc-text">ApplicationContext</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96-1"><span class="toc-number">10.2.1.</span> <span class="toc-text">åˆå§‹åŒ–</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WebApplicationContext"><span class="toc-number">10.3.</span> <span class="toc-text">WebApplicationContext</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96-2"><span class="toc-number">10.3.1.</span> <span class="toc-text">åˆå§‹åŒ–</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E8%A7%A3"><span class="toc-number">10.4.</span> <span class="toc-text">æ³¨è§£</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84"><span class="toc-number">10.5.</span> <span class="toc-text">åå°„</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AOP"><span class="toc-number">11.</span> <span class="toc-text">AOP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%9C%AF%E8%AF%AD"><span class="toc-number">11.1.</span> <span class="toc-text">ç›¸å…³æœ¯è¯­</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A2%9E%E5%BC%BA-advice"><span class="toc-number">11.1.1.</span> <span class="toc-text">å¢å¼º advice</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E7%82%B9-join-point"><span class="toc-number">11.1.2.</span> <span class="toc-text">è¿æ¥ç‚¹ join point</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%87%E7%82%B9-pointcut"><span class="toc-number">11.1.3.</span> <span class="toc-text">åˆ‡ç‚¹ pointcut</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%87%E9%9D%A2-aspect"><span class="toc-number">11.1.4.</span> <span class="toc-text">åˆ‡é¢ aspect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E5%85%A5-introduction"><span class="toc-number">11.1.5.</span> <span class="toc-text">å¼•å…¥ introduction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%87%E5%85%A5-weaving"><span class="toc-number">11.1.6.</span> <span class="toc-text">ç»‡å…¥ weaving</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring%E7%A7%8D%E7%9A%84AOP"><span class="toc-number">11.2.</span> <span class="toc-text">Springç§çš„AOP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E6%97%B6%E5%A2%9E%E5%BC%BA%E5%AF%B9%E8%B1%A1"><span class="toc-number">11.3.</span> <span class="toc-text">è¿è¡Œæ—¶å¢å¼ºå¯¹è±¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%87%E7%82%B9%E7%B1%BB%E5%9E%8B"><span class="toc-number">11.4.</span> <span class="toc-text">åˆ‡ç‚¹ç±»å‹</span></a></li></ol></li></ol>
</div></main>
            <aside class="left-column">
              
              <div class="card card-author">
                
  <img 
    src="/img/little-prince.png" 
    class="author-img"
    width="88"
    height="88"
    alt="author avatar">

<p class="author-name">Neil</p>
<p class="author-description">there's a will there's a way</p>
<div class="author-message">
  <a 
    class="author-posts-count" 
    href="/archives">
    <span>8</span>
    <span>Posts</span>
  </a>
  <a 
    class="author-categories-count" 
    href="/categories">
    <span>6</span>
    <span>Categories</span>
  </a>
  <a 
    class="author-tags-count" 
    href="/tags">
    <span>6</span>
    <span>Tags</span>
  </a>
</div>

              </div>
               <div class="sticky-tablet">
  
  
    <article class="display-when-two-columns spacer">
      <div class="card card-content toc-card">
        <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>TOC
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6"><span class="toc-number">1.</span> <span class="toc-text">ç»„ä»¶</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringBoot%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">SpringBootå¯åŠ¨è¿‡ç¨‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86%E8%BF%87%E7%A8%8B"><span class="toc-number">3.</span> <span class="toc-text">è¯·æ±‚å¤„ç†è¿‡ç¨‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8%E5%92%8C%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-number">4.</span> <span class="toc-text">è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#filter"><span class="toc-number">4.1.</span> <span class="toc-text">filter</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">4.1.1.</span> <span class="toc-text">åº”ç”¨åœºæ™¯</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#interceptor"><span class="toc-number">4.2.</span> <span class="toc-text">interceptor</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-1"><span class="toc-number">4.2.1.</span> <span class="toc-text">åº”ç”¨åœºæ™¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%8E%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-number">5.</span> <span class="toc-text">åå¤„ç†å™¨</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E5%99%A8"><span class="toc-number">6.</span> <span class="toc-text">ç›‘å¬å™¨</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E7%BA%A7%E7%BC%93%E5%AD%98"><span class="toc-number">7.</span> <span class="toc-text">ä¸‰çº§ç¼“å­˜</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#bean%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">8.</span> <span class="toc-text">beanç”Ÿå‘½å‘¨æœŸ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E5%AD%97%E6%8F%8F%E8%BF%B0"><span class="toc-number">8.1.</span> <span class="toc-text">æ–‡å­—æè¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanFactory%E4%B8%ADBean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">8.2.</span> <span class="toc-text">BeanFactoryä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ApplicationContext%E4%B8%ADBean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">8.3.</span> <span class="toc-text">ApplicationContextä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">8.4.</span> <span class="toc-text">ä½œç”¨åŸŸ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BeanFactory-vs-FactoryBean"><span class="toc-number">9.</span> <span class="toc-text">BeanFactory vs FactoryBean</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanFactory"><span class="toc-number">9.1.</span> <span class="toc-text">BeanFactory</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="toc-number">9.1.1.</span> <span class="toc-text">ä¸»è¦æ–¹æ³•ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">9.1.2.</span> <span class="toc-text">ä½¿ç”¨åœºæ™¯</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FactoryBean"><span class="toc-number">9.2.</span> <span class="toc-text">FactoryBean</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E6%96%B9%E6%B3%95%EF%BC%9A-1"><span class="toc-number">9.2.1.</span> <span class="toc-text">ä¸»è¦æ–¹æ³•ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-1"><span class="toc-number">9.2.2.</span> <span class="toc-text">ä½¿ç”¨åœºæ™¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#IoC"><span class="toc-number">10.</span> <span class="toc-text">IoC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanFactory-1"><span class="toc-number">10.1.</span> <span class="toc-text">BeanFactory</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">10.1.1.</span> <span class="toc-text">åˆå§‹åŒ–</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ApplicationContext"><span class="toc-number">10.2.</span> <span class="toc-text">ApplicationContext</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96-1"><span class="toc-number">10.2.1.</span> <span class="toc-text">åˆå§‹åŒ–</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WebApplicationContext"><span class="toc-number">10.3.</span> <span class="toc-text">WebApplicationContext</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96-2"><span class="toc-number">10.3.1.</span> <span class="toc-text">åˆå§‹åŒ–</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E8%A7%A3"><span class="toc-number">10.4.</span> <span class="toc-text">æ³¨è§£</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84"><span class="toc-number">10.5.</span> <span class="toc-text">åå°„</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AOP"><span class="toc-number">11.</span> <span class="toc-text">AOP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%9C%AF%E8%AF%AD"><span class="toc-number">11.1.</span> <span class="toc-text">ç›¸å…³æœ¯è¯­</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A2%9E%E5%BC%BA-advice"><span class="toc-number">11.1.1.</span> <span class="toc-text">å¢å¼º advice</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E7%82%B9-join-point"><span class="toc-number">11.1.2.</span> <span class="toc-text">è¿æ¥ç‚¹ join point</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%87%E7%82%B9-pointcut"><span class="toc-number">11.1.3.</span> <span class="toc-text">åˆ‡ç‚¹ pointcut</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%87%E9%9D%A2-aspect"><span class="toc-number">11.1.4.</span> <span class="toc-text">åˆ‡é¢ aspect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E5%85%A5-introduction"><span class="toc-number">11.1.5.</span> <span class="toc-text">å¼•å…¥ introduction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%87%E5%85%A5-weaving"><span class="toc-number">11.1.6.</span> <span class="toc-text">ç»‡å…¥ weaving</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring%E7%A7%8D%E7%9A%84AOP"><span class="toc-number">11.2.</span> <span class="toc-text">Springç§çš„AOP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E6%97%B6%E5%A2%9E%E5%BC%BA%E5%AF%B9%E8%B1%A1"><span class="toc-number">11.3.</span> <span class="toc-text">è¿è¡Œæ—¶å¢å¼ºå¯¹è±¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%87%E7%82%B9%E7%B1%BB%E5%9E%8B"><span class="toc-number">11.4.</span> <span class="toc-text">åˆ‡ç‚¹ç±»å‹</span></a></li></ol></li></ol>
      </div>
    </article>
  
  
  <article class="card card-content categories-widget">
    <div class="categories-card">
  <div class="categories-header">
    <i 
      class="iconfont icon-fenlei" 
      style="padding-right: 2px;">
    </i>Categories
  </div>
  <div class="categories-list">
    
      <a href="/categories/algs/">
        <div class="categories-list-item">
          algs
          <span class="categories-list-item-badge">1</span>
        </div>
      </a>
    
      <a href="/categories/java/">
        <div class="categories-list-item">
          java
          <span class="categories-list-item-badge">2</span>
        </div>
      </a>
    
      <a href="/categories/mw/">
        <div class="categories-list-item">
          mw
          <span class="categories-list-item-badge">1</span>
        </div>
      </a>
    
      <a href="/categories/cn/">
        <div class="categories-list-item">
          cn
          <span class="categories-list-item-badge">1</span>
        </div>
      </a>
    
      <a href="/categories/db/">
        <div class="categories-list-item">
          db
          <span class="categories-list-item-badge">1</span>
        </div>
      </a>
    
      <a href="/categories/os/">
        <div class="categories-list-item">
          os
          <span class="categories-list-item-badge">1</span>
        </div>
      </a>
    
  </div>
</div>
  </article>
  
  <article class="card card-content tags-widget">
    <div class="tags-card">
  <div class="tags-header">
    <i 
      class="iconfont icon-biaoqian" 
      style="padding-right: 2px;">
    </i>hot tags
  </div>
  <div class="tags-list">
    
      <a 
        href="/tags/java/" 
        title="java">
        <div class="tags-list-item">java</div>
      </a>
    
      <a 
        href="/tags/os/" 
        title="os">
        <div class="tags-list-item">os</div>
      </a>
    
      <a 
        href="/tags/db/" 
        title="db">
        <div class="tags-list-item">db</div>
      </a>
    
      <a 
        href="/tags/cn/" 
        title="cn">
        <div class="tags-list-item">cn</div>
      </a>
    
      <a 
        href="/tags/mw/" 
        title="mw">
        <div class="tags-list-item">mw</div>
      </a>
    
      <a 
        href="/tags/algs/" 
        title="algs">
        <div class="tags-list-item">algs</div>
      </a>
    
  </div>
</div>
  </article>
  
  
</div>
            </aside>
            <aside class="right-column">
              <div class="sticky-widescreen">
  
  
    <article class="card card-content toc-card">
      <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>TOC
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6"><span class="toc-number">1.</span> <span class="toc-text">ç»„ä»¶</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringBoot%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">SpringBootå¯åŠ¨è¿‡ç¨‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86%E8%BF%87%E7%A8%8B"><span class="toc-number">3.</span> <span class="toc-text">è¯·æ±‚å¤„ç†è¿‡ç¨‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8%E5%92%8C%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-number">4.</span> <span class="toc-text">è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#filter"><span class="toc-number">4.1.</span> <span class="toc-text">filter</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">4.1.1.</span> <span class="toc-text">åº”ç”¨åœºæ™¯</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#interceptor"><span class="toc-number">4.2.</span> <span class="toc-text">interceptor</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-1"><span class="toc-number">4.2.1.</span> <span class="toc-text">åº”ç”¨åœºæ™¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%8E%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-number">5.</span> <span class="toc-text">åå¤„ç†å™¨</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E5%99%A8"><span class="toc-number">6.</span> <span class="toc-text">ç›‘å¬å™¨</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E7%BA%A7%E7%BC%93%E5%AD%98"><span class="toc-number">7.</span> <span class="toc-text">ä¸‰çº§ç¼“å­˜</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#bean%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">8.</span> <span class="toc-text">beanç”Ÿå‘½å‘¨æœŸ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E5%AD%97%E6%8F%8F%E8%BF%B0"><span class="toc-number">8.1.</span> <span class="toc-text">æ–‡å­—æè¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanFactory%E4%B8%ADBean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">8.2.</span> <span class="toc-text">BeanFactoryä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ApplicationContext%E4%B8%ADBean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">8.3.</span> <span class="toc-text">ApplicationContextä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">8.4.</span> <span class="toc-text">ä½œç”¨åŸŸ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BeanFactory-vs-FactoryBean"><span class="toc-number">9.</span> <span class="toc-text">BeanFactory vs FactoryBean</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanFactory"><span class="toc-number">9.1.</span> <span class="toc-text">BeanFactory</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="toc-number">9.1.1.</span> <span class="toc-text">ä¸»è¦æ–¹æ³•ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">9.1.2.</span> <span class="toc-text">ä½¿ç”¨åœºæ™¯</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FactoryBean"><span class="toc-number">9.2.</span> <span class="toc-text">FactoryBean</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E6%96%B9%E6%B3%95%EF%BC%9A-1"><span class="toc-number">9.2.1.</span> <span class="toc-text">ä¸»è¦æ–¹æ³•ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-1"><span class="toc-number">9.2.2.</span> <span class="toc-text">ä½¿ç”¨åœºæ™¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#IoC"><span class="toc-number">10.</span> <span class="toc-text">IoC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanFactory-1"><span class="toc-number">10.1.</span> <span class="toc-text">BeanFactory</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">10.1.1.</span> <span class="toc-text">åˆå§‹åŒ–</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ApplicationContext"><span class="toc-number">10.2.</span> <span class="toc-text">ApplicationContext</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96-1"><span class="toc-number">10.2.1.</span> <span class="toc-text">åˆå§‹åŒ–</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WebApplicationContext"><span class="toc-number">10.3.</span> <span class="toc-text">WebApplicationContext</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96-2"><span class="toc-number">10.3.1.</span> <span class="toc-text">åˆå§‹åŒ–</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E8%A7%A3"><span class="toc-number">10.4.</span> <span class="toc-text">æ³¨è§£</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84"><span class="toc-number">10.5.</span> <span class="toc-text">åå°„</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AOP"><span class="toc-number">11.</span> <span class="toc-text">AOP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%9C%AF%E8%AF%AD"><span class="toc-number">11.1.</span> <span class="toc-text">ç›¸å…³æœ¯è¯­</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A2%9E%E5%BC%BA-advice"><span class="toc-number">11.1.1.</span> <span class="toc-text">å¢å¼º advice</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E7%82%B9-join-point"><span class="toc-number">11.1.2.</span> <span class="toc-text">è¿æ¥ç‚¹ join point</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%87%E7%82%B9-pointcut"><span class="toc-number">11.1.3.</span> <span class="toc-text">åˆ‡ç‚¹ pointcut</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%87%E9%9D%A2-aspect"><span class="toc-number">11.1.4.</span> <span class="toc-text">åˆ‡é¢ aspect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E5%85%A5-introduction"><span class="toc-number">11.1.5.</span> <span class="toc-text">å¼•å…¥ introduction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%87%E5%85%A5-weaving"><span class="toc-number">11.1.6.</span> <span class="toc-text">ç»‡å…¥ weaving</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring%E7%A7%8D%E7%9A%84AOP"><span class="toc-number">11.2.</span> <span class="toc-text">Springç§çš„AOP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E6%97%B6%E5%A2%9E%E5%BC%BA%E5%AF%B9%E8%B1%A1"><span class="toc-number">11.3.</span> <span class="toc-text">è¿è¡Œæ—¶å¢å¼ºå¯¹è±¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%87%E7%82%B9%E7%B1%BB%E5%9E%8B"><span class="toc-number">11.4.</span> <span class="toc-text">åˆ‡ç‚¹ç±»å‹</span></a></li></ol></li></ol>
    </article>
  
  
  <article class="card card-content">
    <div class="recent-posts-card">
  <div class="recent-posts-header">
    <i 
      class="iconfont icon-wenzhang_huaban" 
      style="padding-right: 2px;">
    </i>Recent Posts
  </div>
  <div class="recent-posts-list">
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2018-06-03</div>
        <a href="/2018/06/03/cn/"><div class="recent-posts-item-content">cn</div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2018-06-03</div>
        <a href="/2018/06/03/cs/"><div class="recent-posts-item-content">cs</div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2018-06-03</div>
        <a href="/2018/06/03/db/"><div class="recent-posts-item-content">db</div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2018-06-03</div>
        <a href="/2018/06/03/java/"><div class="recent-posts-item-content">java</div></a>
      </div>
    
  </div>
</div>
  </article>
  
  
</div>
            </aside>
          </div>
        </div>
      </div>
    </div>
     
    <footer class="footer">
  <div class="footer-container">
    <div>
      <div class="footer-dsc">
        <span>
          Copyright Â©
          
            2017 -
          
          2022
        </span>
        &nbsp;
        <a 
          href="/" 
          class="footer-link">
          æ‡’èœ—ç‰›
        </a>
      </div>
    </div>

    
      <div class="footer-dsc">
        
          Powered by
          <a 
            href="https://hexo.io/" 
            class="footer-link" 
            target="_blank" 
            rel="nofollow noopener noreferrer">
            &nbsp;Hexo
          </a>
        
        
          <span>&nbsp;|&nbsp;</span>
        
        
          Theme -
          <a 
            href="https://github.com/theme-kaze" 
            class="footer-link" 
            target="_blank"
            rel="nofollow noopener noreferrer">
            &nbsp;Kaze
          </a>
        
      </div>
    
    
    
    
      <div class="footer-dsc">
        
        
        
      </div>
      
    
</footer> 
    
  <a 
    role="button" 
    id="scrollbutton" 
    class="basebutton" 
    aria-label="å›åˆ°é¡¶éƒ¨">
    <i class="iconfont icon-arrowleft button-icon"></i>
  </a>

<a 
  role="button" 
  id="menubutton"
  aria-label="menu button"
  class="basebutton">
  <i class="iconfont icon-menu button-icon"></i>
</a>
<a 
  role="button" 
  id="popbutton" 
  class="basebutton" 
  aria-label="æ§åˆ¶ä¸­å¿ƒ">
  <i class="iconfont icon-expand button-icon"></i>
</a>
<a 
  role="button" 
  id="darkbutton" 
  class="basebutton darkwidget" 
  aria-label="å¤œè‰²æ¨¡å¼">
  <i class="iconfont icon-weather button-icon"></i>
</a>
<a 
  role="button" 
  id="searchbutton" 
  class="basebutton searchwidget" 
  aria-label="æœç´¢">
  <i class="iconfont icon-search button-icon"></i>
</a> 
     
     
      

  
  
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
      };
    </script>
    
<script src="//cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-svg.js"></script>

  
 
     
     
      <script>
  var addImgLayout = function () {
    var img = document.querySelectorAll('.post-content img')
    var i
    for (i = 0; i < img.length; i++) {
      var wrapper = document.createElement('a')
      wrapper.setAttribute('href', img[i].getAttribute('data-src'))
      wrapper.setAttribute('aria-label', 'illustration')
      wrapper.style.cssText =
        'width: 100%; display: flex; justify-content: center;'
      if (img[i].alt) wrapper.dataset.caption = img[i].alt
      wrapper.dataset.nolink = true
      img[i].before(wrapper)
      wrapper.append(img[i])
      var divWrap = document.createElement('div')
      divWrap.classList.add('gallery')
      wrapper.before(divWrap)
      divWrap.append(wrapper)
    }
    baguetteBox.run('.gallery')
  }
</script>
<script>
  loadScript(
    "/js/lib/lightbox/baguetteBox.min.js",
    addImgLayout
  )
</script>
 
     
     
    <script src="/js/main.js"></script> 
    
      <script> 
        loadScript('/js/lib/busuanzi.min.js') 
      </script>
     
    
      <script>
        var addLazyload = function () {
          var observer = lozad('.lozad', {
            load: function (el) {
              el.srcset = el.getAttribute('data-src')
            },
            loaded: function (el) {
              el.classList.add('loaded')
            },
          })
          observer.observe()
        }
      </script>
      <script>
        loadScript('/js/lib/lozad.min.js', addLazyload)
      </script>
     
    
    
      <script>
        setTimeout(() => {localSearch("search.json")}, 0)
      </script>
    
  </body>
</html>
